// Copyright 2023 Goldman Sachs
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import meta::pure::graphFetch::execution::*;
import meta::external::format::shared::functions::*;
import meta::external::format::flatdata::executionPlan::test::*;
import meta::external::format::flatdata::executionPlan::test::bigFile::*;

function <<meta::pure::profiles::test.Test, meta::pure::profiles::test.AlloyOnly>> meta::external::format::flatdata::executionPlan::test::bigFile::testBigFileDeserialization(): Boolean[1]
{
  let binding = getBigFileBinding();

  let tree    = #{BigFile{field0,field1,field2,field3,field4,field5,field6,field7,field8,field9,field10,field11,field12,field13,field14,field15,field16,field17,field18,field19,field20,field21,field22,field23,field24,field25,field26,field27,field28,field29,field30,field31,field32,field33,field34,field35,field36,field37,field38,field39,field40,field41,field42,field43,field44,field45,field46,field47,field48,field49,field50,field51,field52,field53,field54,field55,field56,field57,field58,field59,field60,field61,field62,field63,field64,field65,field66,field67,field68,field69,field70,field71,field72,field73,field74,field75,field76,field77,field78,field79,field80,field81,field82,field83,field84,field85,field86,field87,field88,field89,field90,field91,field92,field93,field94,field95,field96,field97,field98,field99,field100,field101,field102,field103,field104,field105,field106,field107,field108,field109,field110,field111,field112,field113,field114,field115,field116,field117,field118,field119,field120,field121,field122,field123,field124,field125,field126,field127,field128,field129,field130,field131,field132,field133,field134,field135,field136,field137,field138,field139,field140,field141,field142,field143,field144,field145,field146,field147,field148,field149,field150,field151,field152,field153,field154,field155,field156,field157,field158,field159,field160,field161,field162,field163,field164,field165,field166,field167,field168,field169,field170,field171,field172,field173,field174,field175,field176,field177,field178,field179,field180,field181,field182,field183,field184,field185,field186,field187,field188,field189,field190,field191,field192,field193,field194,field195,field196,field197,field198,field199,field200,field201,field202,field203,field204,field205,field206,field207,field208,field209,field210,field211,field212,field213,field214,field215,field216,field217,field218,field219,field220,field221,field222,field223,field224,field225,field226,field227,field228,field229,field230,field231,field232,field233,field234,field235,field236,field237,field238,field239,field240,field241,field242,field243,field244,field245,field246,field247,field248,field249,field250,field251,field252,field253,field254,field255,field256,field257,field258,field259,field260,field261,field262,field263,field264,field265,field266,field267,field268,field269,field270,field271,field272,field273,field274,field275,field276,field277,field278,field279,field280,field281,field282,field283,field284,field285,field286,field287,field288,field289,field290,field291,field292,field293,field294,field295,field296,field297,field298,field299,field300,field301,field302,field303,field304,field305,field306,field307,field308,field309,field310,field311,field312,field313,field314,field315,field316,field317,field318,field319,field320,field321,field322,field323,field324,field325,field326,field327,field328,field329,field330,field331,field332,field333,field334,field335,field336,field337,field338,field339,field340,field341,field342,field343,field344,field345,field346,field347,field348,field349,field350,field351,field352,field353,field354,field355,field356,field357,field358,field359,field360,field361,field362,field363,field364,field365,field366,field367,field368,field369,field370,field371,field372,field373,field374,field375,field376,field377,field378,field379,field380,field381,field382,field383,field384,field385,field386,field387,field388,field389,field390,field391,field392,field393,field394,field395,field396,field397,field398,field399,field400,field401,field402,field403,field404,field405,field406,field407,field408,field409,field410,field411,field412,field413,field414,field415,field416,field417,field418,field419,field420,field421,field422,field423,field424,field425,field426,field427,field428,field429,field430,field431,field432,field433,field434,field435,field436,field437,field438,field439,field440,field441,field442,field443,field444,field445,field446,field447,field448,field449,field450,field451,field452,field453,field454,field455,field456,field457,field458,field459,field460,field461,field462,field463,field464,field465,field466,field467,field468,field469,field470,field471,field472,field473,field474,field475,field476,field477,field478,field479,field480,field481,field482,field483,field484,field485,field486,field487,field488,field489,field490,field491,field492,field493,field494,field495,field496,field497,field498,field499,field500}}#;
  let input   = readFile('/core_external_format_flatdata/executionPlan/tests/resources/bigFile.csv')->toOne();
  let query   = {data:String[1]|BigFile->internalize($binding, $data)->externalize($binding, $tree)};

  let result  = executeFlatdataBindingQuery($query, pair('data', $input));
  
  let expected = 'field0,field1,field2,field3,field4,field5,field6,field7,field8,field9,field10,field11,field12,field13,field14,field15,field16,field17,field18,field19,field20,field21,field22,field23,field24,field25,field26,field27,field28,field29,field30,field31,field32,field33,field34,field35,field36,field37,field38,field39,field40,field41,field42,field43,field44,field45,field46,field47,field48,field49,field50,field51,field52,field53,field54,field55,field56,field57,field58,field59,field60,field61,field62,field63,field64,field65,field66,field67,field68,field69,field70,field71,field72,field73,field74,field75,field76,field77,field78,field79,field80,field81,field82,field83,field84,field85,field86,field87,field88,field89,field90,field91,field92,field93,field94,field95,field96,field97,field98,field99,field100,field101,field102,field103,field104,field105,field106,field107,field108,field109,field110,field111,field112,field113,field114,field115,field116,field117,field118,field119,field120,field121,field122,field123,field124,field125,field126,field127,field128,field129,field130,field131,field132,field133,field134,field135,field136,field137,field138,field139,field140,field141,field142,field143,field144,field145,field146,field147,field148,field149,field150,field151,field152,field153,field154,field155,field156,field157,field158,field159,field160,field161,field162,field163,field164,field165,field166,field167,field168,field169,field170,field171,field172,field173,field174,field175,field176,field177,field178,field179,field180,field181,field182,field183,field184,field185,field186,field187,field188,field189,field190,field191,field192,field193,field194,field195,field196,field197,field198,field199,field200,field201,field202,field203,field204,field205,field206,field207,field208,field209,field210,field211,field212,field213,field214,field215,field216,field217,field218,field219,field220,field221,field222,field223,field224,field225,field226,field227,field228,field229,field230,field231,field232,field233,field234,field235,field236,field237,field238,field239,field240,field241,field242,field243,field244,field245,field246,field247,field248,field249,field250,field251,field252,field253,field254,field255,field256,field257,field258,field259,field260,field261,field262,field263,field264,field265,field266,field267,field268,field269,field270,field271,field272,field273,field274,field275,field276,field277,field278,field279,field280,field281,field282,field283,field284,field285,field286,field287,field288,field289,field290,field291,field292,field293,field294,field295,field296,field297,field298,field299,field300,field301,field302,field303,field304,field305,field306,field307,field308,field309,field310,field311,field312,field313,field314,field315,field316,field317,field318,field319,field320,field321,field322,field323,field324,field325,field326,field327,field328,field329,field330,field331,field332,field333,field334,field335,field336,field337,field338,field339,field340,field341,field342,field343,field344,field345,field346,field347,field348,field349,field350,field351,field352,field353,field354,field355,field356,field357,field358,field359,field360,field361,field362,field363,field364,field365,field366,field367,field368,field369,field370,field371,field372,field373,field374,field375,field376,field377,field378,field379,field380,field381,field382,field383,field384,field385,field386,field387,field388,field389,field390,field391,field392,field393,field394,field395,field396,field397,field398,field399,field400,field401,field402,field403,field404,field405,field406,field407,field408,field409,field410,field411,field412,field413,field414,field415,field416,field417,field418,field419,field420,field421,field422,field423,field424,field425,field426,field427,field428,field429,field430,field431,field432,field433,field434,field435,field436,field437,field438,field439,field440,field441,field442,field443,field444,field445,field446,field447,field448,field449,field450,field451,field452,field453,field454,field455,field456,field457,field458,field459,field460,field461,field462,field463,field464,field465,field466,field467,field468,field469,field470,field471,field472,field473,field474,field475,field476,field477,field478,field479,field480,field481,field482,field483,field484,field485,field486,field487,field488,field489,field490,field491,field492,field493,field494,field495,field496,field497,field498,field499,field500\nfield0,field1,field2,field3,field4,field5,field6,field7,field8,field9,field10,field11,field12,field13,field14,field15,field16,field17,field18,field19,field20,field21,field22,field23,field24,field25,field26,field27,field28,field29,field30,field31,field32,field33,field34,field35,field36,field37,field38,field39,field40,field41,field42,field43,field44,field45,field46,field47,field48,field49,field50,field51,field52,field53,field54,field55,field56,field57,field58,field59,field60,field61,field62,field63,field64,field65,field66,field67,field68,field69,field70,field71,field72,field73,field74,field75,field76,field77,field78,field79,field80,field81,field82,field83,field84,field85,field86,field87,field88,field89,field90,field91,field92,field93,field94,field95,field96,field97,field98,field99,field100,field101,field102,field103,field104,field105,field106,field107,field108,field109,field110,field111,field112,field113,field114,field115,field116,field117,field118,field119,field120,field121,field122,field123,field124,field125,field126,field127,field128,field129,field130,field131,field132,field133,field134,field135,field136,field137,field138,field139,field140,field141,field142,field143,field144,field145,field146,field147,field148,field149,field150,field151,field152,field153,field154,field155,field156,field157,field158,field159,field160,field161,field162,field163,field164,field165,field166,field167,field168,field169,field170,field171,field172,field173,field174,field175,field176,field177,field178,field179,field180,field181,field182,field183,field184,field185,field186,field187,field188,field189,field190,field191,field192,field193,field194,field195,field196,field197,field198,field199,field200,field201,field202,field203,field204,field205,field206,field207,field208,field209,field210,field211,field212,field213,field214,field215,field216,field217,field218,field219,field220,field221,field222,field223,field224,field225,field226,field227,field228,field229,field230,field231,field232,field233,field234,field235,field236,field237,field238,field239,field240,field241,field242,field243,field244,field245,field246,field247,field248,field249,field250,field251,field252,field253,field254,field255,field256,field257,field258,field259,field260,field261,field262,field263,field264,field265,field266,field267,field268,field269,field270,field271,field272,field273,field274,field275,field276,field277,field278,field279,field280,field281,field282,field283,field284,field285,field286,field287,field288,field289,field290,field291,field292,field293,field294,field295,field296,field297,field298,field299,field300,field301,field302,field303,field304,field305,field306,field307,field308,field309,field310,field311,field312,field313,field314,field315,field316,field317,field318,field319,field320,field321,field322,field323,field324,field325,field326,field327,field328,field329,field330,field331,field332,field333,field334,field335,field336,field337,field338,field339,field340,field341,field342,field343,field344,field345,field346,field347,field348,field349,field350,field351,field352,field353,field354,field355,field356,field357,field358,field359,field360,field361,field362,field363,field364,field365,field366,field367,field368,field369,field370,field371,field372,field373,field374,field375,field376,field377,field378,field379,field380,field381,field382,field383,field384,field385,field386,field387,field388,field389,field390,field391,field392,field393,field394,field395,field396,field397,field398,field399,field400,field401,field402,field403,field404,field405,field406,field407,field408,field409,field410,field411,field412,field413,field414,field415,field416,field417,field418,field419,field420,field421,field422,field423,field424,field425,field426,field427,field428,field429,field430,field431,field432,field433,field434,field435,field436,field437,field438,field439,field440,field441,field442,field443,field444,field445,field446,field447,field448,field449,field450,field451,field452,field453,field454,field455,field456,field457,field458,field459,field460,field461,field462,field463,field464,field465,field466,field467,field468,field469,field470,field471,field472,field473,field474,field475,field476,field477,field478,field479,field480,field481,field482,field483,field484,field485,field486,field487,field488,field489,field490,field491,field492,field493,field494,field495,field496,field497,field498,field499,field500\nfield0,field1,field2,field3,field4,field5,field6,field7,field8,field9,field10,field11,field12,field13,field14,field15,field16,field17,field18,field19,field20,field21,field22,field23,field24,field25,field26,field27,field28,field29,field30,field31,field32,field33,field34,field35,field36,field37,field38,field39,field40,field41,field42,field43,field44,field45,field46,field47,field48,field49,field50,field51,field52,field53,field54,field55,field56,field57,field58,field59,field60,field61,field62,field63,field64,field65,field66,field67,field68,field69,field70,field71,field72,field73,field74,field75,field76,field77,field78,field79,field80,field81,field82,field83,field84,field85,field86,field87,field88,field89,field90,field91,field92,field93,field94,field95,field96,field97,field98,field99,field100,field101,field102,field103,field104,field105,field106,field107,field108,field109,field110,field111,field112,field113,field114,field115,field116,field117,field118,field119,field120,field121,field122,field123,field124,field125,field126,field127,field128,field129,field130,field131,field132,field133,field134,field135,field136,field137,field138,field139,field140,field141,field142,field143,field144,field145,field146,field147,field148,field149,field150,field151,field152,field153,field154,field155,field156,field157,field158,field159,field160,field161,field162,field163,field164,field165,field166,field167,field168,field169,field170,field171,field172,field173,field174,field175,field176,field177,field178,field179,field180,field181,field182,field183,field184,field185,field186,field187,field188,field189,field190,field191,field192,field193,field194,field195,field196,field197,field198,field199,field200,field201,field202,field203,field204,field205,field206,field207,field208,field209,field210,field211,field212,field213,field214,field215,field216,field217,field218,field219,field220,field221,field222,field223,field224,field225,field226,field227,field228,field229,field230,field231,field232,field233,field234,field235,field236,field237,field238,field239,field240,field241,field242,field243,field244,field245,field246,field247,field248,field249,field250,field251,field252,field253,field254,field255,field256,field257,field258,field259,field260,field261,field262,field263,field264,field265,field266,field267,field268,field269,field270,field271,field272,field273,field274,field275,field276,field277,field278,field279,field280,field281,field282,field283,field284,field285,field286,field287,field288,field289,field290,field291,field292,field293,field294,field295,field296,field297,field298,field299,field300,field301,field302,field303,field304,field305,field306,field307,field308,field309,field310,field311,field312,field313,field314,field315,field316,field317,field318,field319,field320,field321,field322,field323,field324,field325,field326,field327,field328,field329,field330,field331,field332,field333,field334,field335,field336,field337,field338,field339,field340,field341,field342,field343,field344,field345,field346,field347,field348,field349,field350,field351,field352,field353,field354,field355,field356,field357,field358,field359,field360,field361,field362,field363,field364,field365,field366,field367,field368,field369,field370,field371,field372,field373,field374,field375,field376,field377,field378,field379,field380,field381,field382,field383,field384,field385,field386,field387,field388,field389,field390,field391,field392,field393,field394,field395,field396,field397,field398,field399,field400,field401,field402,field403,field404,field405,field406,field407,field408,field409,field410,field411,field412,field413,field414,field415,field416,field417,field418,field419,field420,field421,field422,field423,field424,field425,field426,field427,field428,field429,field430,field431,field432,field433,field434,field435,field436,field437,field438,field439,field440,field441,field442,field443,field444,field445,field446,field447,field448,field449,field450,field451,field452,field453,field454,field455,field456,field457,field458,field459,field460,field461,field462,field463,field464,field465,field466,field467,field468,field469,field470,field471,field472,field473,field474,field475,field476,field477,field478,field479,field480,field481,field482,field483,field484,field485,field486,field487,field488,field489,field490,field491,field492,field493,field494,field495,field496,field497,field498,field499,field500';
  assertEquals($expected, $result);
}

// =========================================================================================================
// Models
// =========================================================================================================

###Pure
import meta::legend::*;
import meta::external::format::shared::binding::*;

function meta::external::format::flatdata::executionPlan::test::bigFile::getBigFileBinding():Binding[1]
{
  let schema = 
    '###ExternalFormat\n' +
    'Binding meta::external::format::flatdata::executionPlan::test::bigFile::BigFileBinding\n' +
    '{\n' +
    '  schemaSet: meta::external::format::flatdata::executionPlan::test::bigFile::BigFileSchemaSet;\n' +
    '  contentType: \'application/x.flatdata\';\n' +
    '  modelIncludes: [\n' +
    '    meta::external::format::flatdata::executionPlan::test::bigFile::BigFile\n' +
    '  ];\n' +
    '}\n' +
    '\n' +
    '\n' +
    'SchemaSet meta::external::format::flatdata::executionPlan::test::bigFile::BigFileSchemaSet\n' +
    '{\n' +
    '  format: FlatData;\n' +
    '  schemas: [\n' +
    '    {\n' +
    '      content: \'section BigFileSchema: DelimitedWithHeadings \\\n{  \\\n  delimiter: \\\',\\\';  \\\n  scope.untilEof;   \\\n  nullString: \\\'\\\';\\\n  \\\n  Record  \\\n  { \\\n    field0 : STRING;\\\n    field1 : STRING;\\\n    field2 : STRING;\\\n    field3 : STRING;\\\n    field4 : STRING;\\\n    field5 : STRING;\\\n    field6 : STRING;\\\n    field7 : STRING;\\\n    field8 : STRING;\\\n    field9 : STRING;\\\n    field10 : STRING;\\\n    field11 : STRING;\\\n    field12 : STRING;\\\n    field13 : STRING;\\\n    field14 : STRING;\\\n    field15 : STRING;\\\n    field16 : STRING;\\\n    field17 : STRING;\\\n    field18 : STRING;\\\n    field19 : STRING;\\\n    field20 : STRING;\\\n    field21 : STRING;\\\n    field22 : STRING;\\\n    field23 : STRING;\\\n    field24 : STRING;\\\n    field25 : STRING;\\\n    field26 : STRING;\\\n    field27 : STRING;\\\n    field28 : STRING;\\\n    field29 : STRING;\\\n    field30 : STRING;\\\n    field31 : STRING;\\\n    field32 : STRING;\\\n    field33 : STRING;\\\n    field34 : STRING;\\\n    field35 : STRING;\\\n    field36 : STRING;\\\n    field37 : STRING;\\\n    field38 : STRING;\\\n    field39 : STRING;\\\n    field40 : STRING;\\\n    field41 : STRING;\\\n    field42 : STRING;\\\n    field43 : STRING;\\\n    field44 : STRING;\\\n    field45 : STRING;\\\n    field46 : STRING;\\\n    field47 : STRING;\\\n    field48 : STRING;\\\n    field49 : STRING;\\\n    field50 : STRING;\\\n    field51 : STRING;\\\n    field52 : STRING;\\\n    field53 : STRING;\\\n    field54 : STRING;\\\n    field55 : STRING;\\\n    field56 : STRING;\\\n    field57 : STRING;\\\n    field58 : STRING;\\\n    field59 : STRING;\\\n    field60 : STRING;\\\n    field61 : STRING;\\\n    field62 : STRING;\\\n    field63 : STRING;\\\n    field64 : STRING;\\\n    field65 : STRING;\\\n    field66 : STRING;\\\n    field67 : STRING;\\\n    field68 : STRING;\\\n    field69 : STRING;\\\n    field70 : STRING;\\\n    field71 : STRING;\\\n    field72 : STRING;\\\n    field73 : STRING;\\\n    field74 : STRING;\\\n    field75 : STRING;\\\n    field76 : STRING;\\\n    field77 : STRING;\\\n    field78 : STRING;\\\n    field79 : STRING;\\\n    field80 : STRING;\\\n    field81 : STRING;\\\n    field82 : STRING;\\\n    field83 : STRING;\\\n    field84 : STRING;\\\n    field85 : STRING;\\\n    field86 : STRING;\\\n    field87 : STRING;\\\n    field88 : STRING;\\\n    field89 : STRING;\\\n    field90 : STRING;\\\n    field91 : STRING;\\\n    field92 : STRING;\\\n    field93 : STRING;\\\n    field94 : STRING;\\\n    field95 : STRING;\\\n    field96 : STRING;\\\n    field97 : STRING;\\\n    field98 : STRING;\\\n    field99 : STRING;\\\n    field100 : STRING;\\\n    field101 : STRING;\\\n    field102 : STRING;\\\n    field103 : STRING;\\\n    field104 : STRING;\\\n    field105 : STRING;\\\n    field106 : STRING;\\\n    field107 : STRING;\\\n    field108 : STRING;\\\n    field109 : STRING;\\\n    field110 : STRING;\\\n    field111 : STRING;\\\n    field112 : STRING;\\\n    field113 : STRING;\\\n    field114 : STRING;\\\n    field115 : STRING;\\\n    field116 : STRING;\\\n    field117 : STRING;\\\n    field118 : STRING;\\\n    field119 : STRING;\\\n    field120 : STRING;\\\n    field121 : STRING;\\\n    field122 : STRING;\\\n    field123 : STRING;\\\n    field124 : STRING;\\\n    field125 : STRING;\\\n    field126 : STRING;\\\n    field127 : STRING;\\\n    field128 : STRING;\\\n    field129 : STRING;\\\n    field130 : STRING;\\\n    field131 : STRING;\\\n    field132 : STRING;\\\n    field133 : STRING;\\\n    field134 : STRING;\\\n    field135 : STRING;\\\n    field136 : STRING;\\\n    field137 : STRING;\\\n    field138 : STRING;\\\n    field139 : STRING;\\\n    field140 : STRING;\\\n    field141 : STRING;\\\n    field142 : STRING;\\\n    field143 : STRING;\\\n    field144 : STRING;\\\n    field145 : STRING;\\\n    field146 : STRING;\\\n    field147 : STRING;\\\n    field148 : STRING;\\\n    field149 : STRING;\\\n    field150 : STRING;\\\n    field151 : STRING;\\\n    field152 : STRING;\\\n    field153 : STRING;\\\n    field154 : STRING;\\\n    field155 : STRING;\\\n    field156 : STRING;\\\n    field157 : STRING;\\\n    field158 : STRING;\\\n    field159 : STRING;\\\n    field160 : STRING;\\\n    field161 : STRING;\\\n    field162 : STRING;\\\n    field163 : STRING;\\\n    field164 : STRING;\\\n    field165 : STRING;\\\n    field166 : STRING;\\\n    field167 : STRING;\\\n    field168 : STRING;\\\n    field169 : STRING;\\\n    field170 : STRING;\\\n    field171 : STRING;\\\n    field172 : STRING;\\\n    field173 : STRING;\\\n    field174 : STRING;\\\n    field175 : STRING;\\\n    field176 : STRING;\\\n    field177 : STRING;\\\n    field178 : STRING;\\\n    field179 : STRING;\\\n    field180 : STRING;\\\n    field181 : STRING;\\\n    field182 : STRING;\\\n    field183 : STRING;\\\n    field184 : STRING;\\\n    field185 : STRING;\\\n    field186 : STRING;\\\n    field187 : STRING;\\\n    field188 : STRING;\\\n    field189 : STRING;\\\n    field190 : STRING;\\\n    field191 : STRING;\\\n    field192 : STRING;\\\n    field193 : STRING;\\\n    field194 : STRING;\\\n    field195 : STRING;\\\n    field196 : STRING;\\\n    field197 : STRING;\\\n    field198 : STRING;\\\n    field199 : STRING;\\\n    field200 : STRING;\\\n    field201 : STRING;\\\n    field202 : STRING;\\\n    field203 : STRING;\\\n    field204 : STRING;\\\n    field205 : STRING;\\\n    field206 : STRING;\\\n    field207 : STRING;\\\n    field208 : STRING;\\\n    field209 : STRING;\\\n    field210 : STRING;\\\n    field211 : STRING;\\\n    field212 : STRING;\\\n    field213 : STRING;\\\n    field214 : STRING;\\\n    field215 : STRING;\\\n    field216 : STRING;\\\n    field217 : STRING;\\\n    field218 : STRING;\\\n    field219 : STRING;\\\n    field220 : STRING;\\\n    field221 : STRING;\\\n    field222 : STRING;\\\n    field223 : STRING;\\\n    field224 : STRING;\\\n    field225 : STRING;\\\n    field226 : STRING;\\\n    field227 : STRING;\\\n    field228 : STRING;\\\n    field229 : STRING;\\\n    field230 : STRING;\\\n    field231 : STRING;\\\n    field232 : STRING;\\\n    field233 : STRING;\\\n    field234 : STRING;\\\n    field235 : STRING;\\\n    field236 : STRING;\\\n    field237 : STRING;\\\n    field238 : STRING;\\\n    field239 : STRING;\\\n    field240 : STRING;\\\n    field241 : STRING;\\\n    field242 : STRING;\\\n    field243 : STRING;\\\n    field244 : STRING;\\\n    field245 : STRING;\\\n    field246 : STRING;\\\n    field247 : STRING;\\\n    field248 : STRING;\\\n    field249 : STRING;\\\n    field250 : STRING;\\\n    field251 : STRING;\\\n    field252 : STRING;\\\n    field253 : STRING;\\\n    field254 : STRING;\\\n    field255 : STRING;\\\n    field256 : STRING;\\\n    field257 : STRING;\\\n    field258 : STRING;\\\n    field259 : STRING;\\\n    field260 : STRING;\\\n    field261 : STRING;\\\n    field262 : STRING;\\\n    field263 : STRING;\\\n    field264 : STRING;\\\n    field265 : STRING;\\\n    field266 : STRING;\\\n    field267 : STRING;\\\n    field268 : STRING;\\\n    field269 : STRING;\\\n    field270 : STRING;\\\n    field271 : STRING;\\\n    field272 : STRING;\\\n    field273 : STRING;\\\n    field274 : STRING;\\\n    field275 : STRING;\\\n    field276 : STRING;\\\n    field277 : STRING;\\\n    field278 : STRING;\\\n    field279 : STRING;\\\n    field280 : STRING;\\\n    field281 : STRING;\\\n    field282 : STRING;\\\n    field283 : STRING;\\\n    field284 : STRING;\\\n    field285 : STRING;\\\n    field286 : STRING;\\\n    field287 : STRING;\\\n    field288 : STRING;\\\n    field289 : STRING;\\\n    field290 : STRING;\\\n    field291 : STRING;\\\n    field292 : STRING;\\\n    field293 : STRING;\\\n    field294 : STRING;\\\n    field295 : STRING;\\\n    field296 : STRING;\\\n    field297 : STRING;\\\n    field298 : STRING;\\\n    field299 : STRING;\\\n    field300 : STRING;\\\n    field301 : STRING;\\\n    field302 : STRING;\\\n    field303 : STRING;\\\n    field304 : STRING;\\\n    field305 : STRING;\\\n    field306 : STRING;\\\n    field307 : STRING;\\\n    field308 : STRING;\\\n    field309 : STRING;\\\n    field310 : STRING;\\\n    field311 : STRING;\\\n    field312 : STRING;\\\n    field313 : STRING;\\\n    field314 : STRING;\\\n    field315 : STRING;\\\n    field316 : STRING;\\\n    field317 : STRING;\\\n    field318 : STRING;\\\n    field319 : STRING;\\\n    field320 : STRING;\\\n    field321 : STRING;\\\n    field322 : STRING;\\\n    field323 : STRING;\\\n    field324 : STRING;\\\n    field325 : STRING;\\\n    field326 : STRING;\\\n    field327 : STRING;\\\n    field328 : STRING;\\\n    field329 : STRING;\\\n    field330 : STRING;\\\n    field331 : STRING;\\\n    field332 : STRING;\\\n    field333 : STRING;\\\n    field334 : STRING;\\\n    field335 : STRING;\\\n    field336 : STRING;\\\n    field337 : STRING;\\\n    field338 : STRING;\\\n    field339 : STRING;\\\n    field340 : STRING;\\\n    field341 : STRING;\\\n    field342 : STRING;\\\n    field343 : STRING;\\\n    field344 : STRING;\\\n    field345 : STRING;\\\n    field346 : STRING;\\\n    field347 : STRING;\\\n    field348 : STRING;\\\n    field349 : STRING;\\\n    field350 : STRING;\\\n    field351 : STRING;\\\n    field352 : STRING;\\\n    field353 : STRING;\\\n    field354 : STRING;\\\n    field355 : STRING;\\\n    field356 : STRING;\\\n    field357 : STRING;\\\n    field358 : STRING;\\\n    field359 : STRING;\\\n    field360 : STRING;\\\n    field361 : STRING;\\\n    field362 : STRING;\\\n    field363 : STRING;\\\n    field364 : STRING;\\\n    field365 : STRING;\\\n    field366 : STRING;\\\n    field367 : STRING;\\\n    field368 : STRING;\\\n    field369 : STRING;\\\n    field370 : STRING;\\\n    field371 : STRING;\\\n    field372 : STRING;\\\n    field373 : STRING;\\\n    field374 : STRING;\\\n    field375 : STRING;\\\n    field376 : STRING;\\\n    field377 : STRING;\\\n    field378 : STRING;\\\n    field379 : STRING;\\\n    field380 : STRING;\\\n    field381 : STRING;\\\n    field382 : STRING;\\\n    field383 : STRING;\\\n    field384 : STRING;\\\n    field385 : STRING;\\\n    field386 : STRING;\\\n    field387 : STRING;\\\n    field388 : STRING;\\\n    field389 : STRING;\\\n    field390 : STRING;\\\n    field391 : STRING;\\\n    field392 : STRING;\\\n    field393 : STRING;\\\n    field394 : STRING;\\\n    field395 : STRING;\\\n    field396 : STRING;\\\n    field397 : STRING;\\\n    field398 : STRING;\\\n    field399 : STRING;\\\n    field400 : STRING;\\\n    field401 : STRING;\\\n    field402 : STRING;\\\n    field403 : STRING;\\\n    field404 : STRING;\\\n    field405 : STRING;\\\n    field406 : STRING;\\\n    field407 : STRING;\\\n    field408 : STRING;\\\n    field409 : STRING;\\\n    field410 : STRING;\\\n    field411 : STRING;\\\n    field412 : STRING;\\\n    field413 : STRING;\\\n    field414 : STRING;\\\n    field415 : STRING;\\\n    field416 : STRING;\\\n    field417 : STRING;\\\n    field418 : STRING;\\\n    field419 : STRING;\\\n    field420 : STRING;\\\n    field421 : STRING;\\\n    field422 : STRING;\\\n    field423 : STRING;\\\n    field424 : STRING;\\\n    field425 : STRING;\\\n    field426 : STRING;\\\n    field427 : STRING;\\\n    field428 : STRING;\\\n    field429 : STRING;\\\n    field430 : STRING;\\\n    field431 : STRING;\\\n    field432 : STRING;\\\n    field433 : STRING;\\\n    field434 : STRING;\\\n    field435 : STRING;\\\n    field436 : STRING;\\\n    field437 : STRING;\\\n    field438 : STRING;\\\n    field439 : STRING;\\\n    field440 : STRING;\\\n    field441 : STRING;\\\n    field442 : STRING;\\\n    field443 : STRING;\\\n    field444 : STRING;\\\n    field445 : STRING;\\\n    field446 : STRING;\\\n    field447 : STRING;\\\n    field448 : STRING;\\\n    field449 : STRING;\\\n    field450 : STRING;\\\n    field451 : STRING;\\\n    field452 : STRING;\\\n    field453 : STRING;\\\n    field454 : STRING;\\\n    field455 : STRING;\\\n    field456 : STRING;\\\n    field457 : STRING;\\\n    field458 : STRING;\\\n    field459 : STRING;\\\n    field460 : STRING;\\\n    field461 : STRING;\\\n    field462 : STRING;\\\n    field463 : STRING;\\\n    field464 : STRING;\\\n    field465 : STRING;\\\n    field466 : STRING;\\\n    field467 : STRING;\\\n    field468 : STRING;\\\n    field469 : STRING;\\\n    field470 : STRING;\\\n    field471 : STRING;\\\n    field472 : STRING;\\\n    field473 : STRING;\\\n    field474 : STRING;\\\n    field475 : STRING;\\\n    field476 : STRING;\\\n    field477 : STRING;\\\n    field478 : STRING;\\\n    field479 : STRING;\\\n    field480 : STRING;\\\n    field481 : STRING;\\\n    field482 : STRING;\\\n    field483 : STRING;\\\n    field484 : STRING;\\\n    field485 : STRING;\\\n    field486 : STRING;\\\n    field487 : STRING;\\\n    field488 : STRING;\\\n    field489 : STRING;\\\n    field490 : STRING;\\\n    field491 : STRING;\\\n    field492 : STRING;\\\n    field493 : STRING;\\\n    field494 : STRING;\\\n    field495 : STRING;\\\n    field496 : STRING;\\\n    field497 : STRING;\\\n    field498 : STRING;\\\n    field499 : STRING;\\\n    field500 : STRING;\\\n  }\\\n}\';' +
    '    }\n' +
    '  ];\n' +
    '}\n';
  
  compileLegendGrammar($schema)->filter(ele | $ele->instanceOf(Binding))->cast(@Binding)->toOne();
}

Class meta::external::format::flatdata::executionPlan::test::bigFile::BigFile
{
  field0: String[1];
  field1: String[1];
  field2: String[1];
  field3: String[1];
  field4: String[1];
  field5: String[1];
  field6: String[1];
  field7: String[1];
  field8: String[1];
  field9: String[1];
  field10: String[1];
  field11: String[1];
  field12: String[1];
  field13: String[1];
  field14: String[1];
  field15: String[1];
  field16: String[1];
  field17: String[1];
  field18: String[1];
  field19: String[1];
  field20: String[1];
  field21: String[1];
  field22: String[1];
  field23: String[1];
  field24: String[1];
  field25: String[1];
  field26: String[1];
  field27: String[1];
  field28: String[1];
  field29: String[1];
  field30: String[1];
  field31: String[1];
  field32: String[1];
  field33: String[1];
  field34: String[1];
  field35: String[1];
  field36: String[1];
  field37: String[1];
  field38: String[1];
  field39: String[1];
  field40: String[1];
  field41: String[1];
  field42: String[1];
  field43: String[1];
  field44: String[1];
  field45: String[1];
  field46: String[1];
  field47: String[1];
  field48: String[1];
  field49: String[1];
  field50: String[1];
  field51: String[1];
  field52: String[1];
  field53: String[1];
  field54: String[1];
  field55: String[1];
  field56: String[1];
  field57: String[1];
  field58: String[1];
  field59: String[1];
  field60: String[1];
  field61: String[1];
  field62: String[1];
  field63: String[1];
  field64: String[1];
  field65: String[1];
  field66: String[1];
  field67: String[1];
  field68: String[1];
  field69: String[1];
  field70: String[1];
  field71: String[1];
  field72: String[1];
  field73: String[1];
  field74: String[1];
  field75: String[1];
  field76: String[1];
  field77: String[1];
  field78: String[1];
  field79: String[1];
  field80: String[1];
  field81: String[1];
  field82: String[1];
  field83: String[1];
  field84: String[1];
  field85: String[1];
  field86: String[1];
  field87: String[1];
  field88: String[1];
  field89: String[1];
  field90: String[1];
  field91: String[1];
  field92: String[1];
  field93: String[1];
  field94: String[1];
  field95: String[1];
  field96: String[1];
  field97: String[1];
  field98: String[1];
  field99: String[1];
  field100: String[1];
  field101: String[1];
  field102: String[1];
  field103: String[1];
  field104: String[1];
  field105: String[1];
  field106: String[1];
  field107: String[1];
  field108: String[1];
  field109: String[1];
  field110: String[1];
  field111: String[1];
  field112: String[1];
  field113: String[1];
  field114: String[1];
  field115: String[1];
  field116: String[1];
  field117: String[1];
  field118: String[1];
  field119: String[1];
  field120: String[1];
  field121: String[1];
  field122: String[1];
  field123: String[1];
  field124: String[1];
  field125: String[1];
  field126: String[1];
  field127: String[1];
  field128: String[1];
  field129: String[1];
  field130: String[1];
  field131: String[1];
  field132: String[1];
  field133: String[1];
  field134: String[1];
  field135: String[1];
  field136: String[1];
  field137: String[1];
  field138: String[1];
  field139: String[1];
  field140: String[1];
  field141: String[1];
  field142: String[1];
  field143: String[1];
  field144: String[1];
  field145: String[1];
  field146: String[1];
  field147: String[1];
  field148: String[1];
  field149: String[1];
  field150: String[1];
  field151: String[1];
  field152: String[1];
  field153: String[1];
  field154: String[1];
  field155: String[1];
  field156: String[1];
  field157: String[1];
  field158: String[1];
  field159: String[1];
  field160: String[1];
  field161: String[1];
  field162: String[1];
  field163: String[1];
  field164: String[1];
  field165: String[1];
  field166: String[1];
  field167: String[1];
  field168: String[1];
  field169: String[1];
  field170: String[1];
  field171: String[1];
  field172: String[1];
  field173: String[1];
  field174: String[1];
  field175: String[1];
  field176: String[1];
  field177: String[1];
  field178: String[1];
  field179: String[1];
  field180: String[1];
  field181: String[1];
  field182: String[1];
  field183: String[1];
  field184: String[1];
  field185: String[1];
  field186: String[1];
  field187: String[1];
  field188: String[1];
  field189: String[1];
  field190: String[1];
  field191: String[1];
  field192: String[1];
  field193: String[1];
  field194: String[1];
  field195: String[1];
  field196: String[1];
  field197: String[1];
  field198: String[1];
  field199: String[1];
  field200: String[1];
  field201: String[1];
  field202: String[1];
  field203: String[1];
  field204: String[1];
  field205: String[1];
  field206: String[1];
  field207: String[1];
  field208: String[1];
  field209: String[1];
  field210: String[1];
  field211: String[1];
  field212: String[1];
  field213: String[1];
  field214: String[1];
  field215: String[1];
  field216: String[1];
  field217: String[1];
  field218: String[1];
  field219: String[1];
  field220: String[1];
  field221: String[1];
  field222: String[1];
  field223: String[1];
  field224: String[1];
  field225: String[1];
  field226: String[1];
  field227: String[1];
  field228: String[1];
  field229: String[1];
  field230: String[1];
  field231: String[1];
  field232: String[1];
  field233: String[1];
  field234: String[1];
  field235: String[1];
  field236: String[1];
  field237: String[1];
  field238: String[1];
  field239: String[1];
  field240: String[1];
  field241: String[1];
  field242: String[1];
  field243: String[1];
  field244: String[1];
  field245: String[1];
  field246: String[1];
  field247: String[1];
  field248: String[1];
  field249: String[1];
  field250: String[1];
  field251: String[1];
  field252: String[1];
  field253: String[1];
  field254: String[1];
  field255: String[1];
  field256: String[1];
  field257: String[1];
  field258: String[1];
  field259: String[1];
  field260: String[1];
  field261: String[1];
  field262: String[1];
  field263: String[1];
  field264: String[1];
  field265: String[1];
  field266: String[1];
  field267: String[1];
  field268: String[1];
  field269: String[1];
  field270: String[1];
  field271: String[1];
  field272: String[1];
  field273: String[1];
  field274: String[1];
  field275: String[1];
  field276: String[1];
  field277: String[1];
  field278: String[1];
  field279: String[1];
  field280: String[1];
  field281: String[1];
  field282: String[1];
  field283: String[1];
  field284: String[1];
  field285: String[1];
  field286: String[1];
  field287: String[1];
  field288: String[1];
  field289: String[1];
  field290: String[1];
  field291: String[1];
  field292: String[1];
  field293: String[1];
  field294: String[1];
  field295: String[1];
  field296: String[1];
  field297: String[1];
  field298: String[1];
  field299: String[1];
  field300: String[1];
  field301: String[1];
  field302: String[1];
  field303: String[1];
  field304: String[1];
  field305: String[1];
  field306: String[1];
  field307: String[1];
  field308: String[1];
  field309: String[1];
  field310: String[1];
  field311: String[1];
  field312: String[1];
  field313: String[1];
  field314: String[1];
  field315: String[1];
  field316: String[1];
  field317: String[1];
  field318: String[1];
  field319: String[1];
  field320: String[1];
  field321: String[1];
  field322: String[1];
  field323: String[1];
  field324: String[1];
  field325: String[1];
  field326: String[1];
  field327: String[1];
  field328: String[1];
  field329: String[1];
  field330: String[1];
  field331: String[1];
  field332: String[1];
  field333: String[1];
  field334: String[1];
  field335: String[1];
  field336: String[1];
  field337: String[1];
  field338: String[1];
  field339: String[1];
  field340: String[1];
  field341: String[1];
  field342: String[1];
  field343: String[1];
  field344: String[1];
  field345: String[1];
  field346: String[1];
  field347: String[1];
  field348: String[1];
  field349: String[1];
  field350: String[1];
  field351: String[1];
  field352: String[1];
  field353: String[1];
  field354: String[1];
  field355: String[1];
  field356: String[1];
  field357: String[1];
  field358: String[1];
  field359: String[1];
  field360: String[1];
  field361: String[1];
  field362: String[1];
  field363: String[1];
  field364: String[1];
  field365: String[1];
  field366: String[1];
  field367: String[1];
  field368: String[1];
  field369: String[1];
  field370: String[1];
  field371: String[1];
  field372: String[1];
  field373: String[1];
  field374: String[1];
  field375: String[1];
  field376: String[1];
  field377: String[1];
  field378: String[1];
  field379: String[1];
  field380: String[1];
  field381: String[1];
  field382: String[1];
  field383: String[1];
  field384: String[1];
  field385: String[1];
  field386: String[1];
  field387: String[1];
  field388: String[1];
  field389: String[1];
  field390: String[1];
  field391: String[1];
  field392: String[1];
  field393: String[1];
  field394: String[1];
  field395: String[1];
  field396: String[1];
  field397: String[1];
  field398: String[1];
  field399: String[1];
  field400: String[1];
  field401: String[1];
  field402: String[1];
  field403: String[1];
  field404: String[1];
  field405: String[1];
  field406: String[1];
  field407: String[1];
  field408: String[1];
  field409: String[1];
  field410: String[1];
  field411: String[1];
  field412: String[1];
  field413: String[1];
  field414: String[1];
  field415: String[1];
  field416: String[1];
  field417: String[1];
  field418: String[1];
  field419: String[1];
  field420: String[1];
  field421: String[1];
  field422: String[1];
  field423: String[1];
  field424: String[1];
  field425: String[1];
  field426: String[1];
  field427: String[1];
  field428: String[1];
  field429: String[1];
  field430: String[1];
  field431: String[1];
  field432: String[1];
  field433: String[1];
  field434: String[1];
  field435: String[1];
  field436: String[1];
  field437: String[1];
  field438: String[1];
  field439: String[1];
  field440: String[1];
  field441: String[1];
  field442: String[1];
  field443: String[1];
  field444: String[1];
  field445: String[1];
  field446: String[1];
  field447: String[1];
  field448: String[1];
  field449: String[1];
  field450: String[1];
  field451: String[1];
  field452: String[1];
  field453: String[1];
  field454: String[1];
  field455: String[1];
  field456: String[1];
  field457: String[1];
  field458: String[1];
  field459: String[1];
  field460: String[1];
  field461: String[1];
  field462: String[1];
  field463: String[1];
  field464: String[1];
  field465: String[1];
  field466: String[1];
  field467: String[1];
  field468: String[1];
  field469: String[1];
  field470: String[1];
  field471: String[1];
  field472: String[1];
  field473: String[1];
  field474: String[1];
  field475: String[1];
  field476: String[1];
  field477: String[1];
  field478: String[1];
  field479: String[1];
  field480: String[1];
  field481: String[1];
  field482: String[1];
  field483: String[1];
  field484: String[1];
  field485: String[1];
  field486: String[1];
  field487: String[1];
  field488: String[1];
  field489: String[1];
  field490: String[1];
  field491: String[1];
  field492: String[1];
  field493: String[1];
  field494: String[1];
  field495: String[1];
  field496: String[1];
  field497: String[1];
  field498: String[1];
  field499: String[1];
  field500: String[1];
}
