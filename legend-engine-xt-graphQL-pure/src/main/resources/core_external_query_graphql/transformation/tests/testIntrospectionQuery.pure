import meta::external::query::graphQL::transformation::introspection::tests::*;

Class meta::external::query::graphQL::transformation::introspection::tests::Firm
{
  legalName : String[1];
  employees : meta::external::query::graphQL::transformation::introspection::tests::Person[*];
  isPublicEntity: Boolean[1];
}

Class meta::external::query::graphQL::transformation::introspection::tests::Person
{
  id: Integer[1];
  firstName : String[1];
  lastName : String[1];
  date : Date[1];
  dateTime : DateTime[1];
  strictDate: StrictDate[1];
  decimal: Decimal[1];
}

Class meta::external::query::graphQL::transformation::introspection::tests::Domain extends meta::external::query::graphQL::transformation::introspection::BaseGraphQLType
{
  firmByLegalName(legalName : String[1])
  {
    Firm.all()->filter(f|$f.legalName == $legalName)->first()
  }: Firm[0..1];
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testSimpleIntrospection():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(Firm, $query);
  assertJsonStringsEqual('{"__schema":{"types":[{"interfaces":[],"possibleTypes":[],"name":"BigDecimal","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Boolean","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Date","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"DateTime","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Firm","enumValues":[],"inputFields":[],"fields":[{"deprecationReason":null,"name":"legalName","args":[],"type":{"name":null,"ofType":{"name":"String","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"employees","args":[],"type":{"name":null,"ofType":{"name":"Person","ofType":null,"kind":"OBJECT"},"kind":"LIST"},"isDeprecated":false},{"deprecationReason":null,"name":"isPublicEntity","args":[],"type":{"name":null,"ofType":{"name":"Boolean","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false}],"kind":"OBJECT"},{"interfaces":[],"possibleTypes":[],"name":"Float","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Int","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Person","enumValues":[],"inputFields":[],"fields":[{"deprecationReason":null,"name":"id","args":[],"type":{"name":null,"ofType":{"name":"Int","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"firstName","args":[],"type":{"name":null,"ofType":{"name":"String","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"lastName","args":[],"type":{"name":null,"ofType":{"name":"String","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"date","args":[],"type":{"name":null,"ofType":{"name":"Date","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"dateTime","args":[],"type":{"name":null,"ofType":{"name":"DateTime","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"strictDate","args":[],"type":{"name":null,"ofType":{"name":"StrictDate","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"decimal","args":[],"type":{"name":null,"ofType":{"name":"BigDecimal","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false}],"kind":"OBJECT"},{"interfaces":[],"possibleTypes":[],"name":"StrictDate","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"String","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"}],"mutationType":null,"queryType":{"name":"Firm"},"directives":[]}}', $strSresult);
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testIntrospectionWithQualified():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(meta::external::query::graphQL::transformation::introspection::tests::Domain, $query);
  assertJsonStringsEqual('{"__schema":{"types":[{"interfaces":[],"possibleTypes":[],"name":"BigDecimal","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Boolean","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Date","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"DateTime","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Domain","enumValues":[],"inputFields":[],"fields":[{"deprecationReason":null,"name":"firmByLegalName","args":[{"type":{"name":"String","ofType":null,"kind":"SCALAR"},"name":"legalName","defaultValue":null}],"type":{"name":"Firm","ofType":null,"kind":"OBJECT"},"isDeprecated":false}],"kind":"OBJECT"},{"interfaces":[],"possibleTypes":[],"name":"Firm","enumValues":[],"inputFields":[],"fields":[{"deprecationReason":null,"name":"legalName","args":[],"type":{"name":null,"ofType":{"name":"String","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"employees","args":[],"type":{"name":null,"ofType":{"name":"Person","ofType":null,"kind":"OBJECT"},"kind":"LIST"},"isDeprecated":false},{"deprecationReason":null,"name":"isPublicEntity","args":[],"type":{"name":null,"ofType":{"name":"Boolean","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false}],"kind":"OBJECT"},{"interfaces":[],"possibleTypes":[],"name":"Float","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Int","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"Person","enumValues":[],"inputFields":[],"fields":[{"deprecationReason":null,"name":"id","args":[],"type":{"name":null,"ofType":{"name":"Int","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"firstName","args":[],"type":{"name":null,"ofType":{"name":"String","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"lastName","args":[],"type":{"name":null,"ofType":{"name":"String","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"date","args":[],"type":{"name":null,"ofType":{"name":"Date","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"dateTime","args":[],"type":{"name":null,"ofType":{"name":"DateTime","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"strictDate","args":[],"type":{"name":null,"ofType":{"name":"StrictDate","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false},{"deprecationReason":null,"name":"decimal","args":[],"type":{"name":null,"ofType":{"name":"BigDecimal","ofType":null,"kind":"SCALAR"},"kind":"NON_NULL"},"isDeprecated":false}],"kind":"OBJECT"},{"interfaces":[],"possibleTypes":[],"name":"StrictDate","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"},{"interfaces":[],"possibleTypes":[],"name":"String","enumValues":[],"inputFields":[],"fields":[],"kind":"SCALAR"}],"mutationType":null,"queryType":{"name":"Domain"},"directives":[]}}', $strSresult);
}