import meta::external::query::graphQL::transformation::introspection::tests::*;

Class meta::external::query::graphQL::transformation::introspection::tests::Firm
{
  legalName : String[1];
  employees : meta::external::query::graphQL::transformation::introspection::tests::Person[*];
  isPublicEntity: Boolean[1];
}

Class meta::external::query::graphQL::transformation::introspection::tests::Person
{
  id: Integer[1];
  firstName : String[1];
  lastName : String[1];
  date : Date[1];
  dateTime : DateTime[1];
  strictDate: StrictDate[1];
  decimal: Decimal[1];
}

Class meta::external::query::graphQL::transformation::introspection::tests::Domain extends meta::external::query::graphQL::transformation::introspection::BaseGraphQLType
{
  firmByLegalName(legalName : String[1])
  {
    Firm.all()->filter(f|$f.legalName == $legalName)->first()
  }: Firm[0..1];

}

Class meta::external::query::graphQL::transformation::introspection::tests::Domain2 extends meta::external::query::graphQL::transformation::introspection::BaseGraphQLType
{
  firmByLegalNames(legalNames : String[*])
  {
    Firm.all()->filter(f|$f.legalName->in($legalNames))
  }: Firm[*];
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testSimpleIntrospection():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(Firm, $query);
  assertJsonStringsEqual('{"__schema":{"types":[{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"BigDecimal"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Boolean"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Date"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"DateTime"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"legalName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"employees","type":{"kind":"LIST","ofType":{"kind":"OBJECT","ofType":null,"name":"Person"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"isPublicEntity","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Boolean"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Firm"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Float"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Int"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"id","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Int"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"firstName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"lastName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"date","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Date"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"dateTime","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"DateTime"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"strictDate","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"StrictDate"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"decimal","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"BigDecimal"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Person"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"StrictDate"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"String"}],"directives":[{"locations":["FIELD"],"args":[],"name":"echo"},{"locations":["FIELD"],"args":[],"name":"totalCount"}],"queryType":{"name":"Firm"},"mutationType":null}}', $strSresult);
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testIntrospectionWithQualified():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(meta::external::query::graphQL::transformation::introspection::tests::Domain, $query);
  assertJsonStringsEqual('{"__schema":{"types":[{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"BigDecimal"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Boolean"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Date"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"DateTime"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[{"name":"legalName","defaultValue":null,"type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}}],"name":"firmByLegalName","type":{"kind":"OBJECT","ofType":null,"name":"Firm"}}],"interfaces":[],"inputFields":[],"name":"Domain"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"legalName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"employees","type":{"kind":"LIST","ofType":{"kind":"OBJECT","ofType":null,"name":"Person"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"isPublicEntity","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Boolean"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Firm"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Float"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Int"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"id","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Int"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"firstName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"lastName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"date","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Date"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"dateTime","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"DateTime"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"strictDate","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"StrictDate"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"decimal","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"BigDecimal"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Person"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"StrictDate"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"String"}],"directives":[{"locations":["FIELD"],"args":[],"name":"echo"},{"locations":["FIELD"],"args":[],"name":"totalCount"}],"queryType":{"name":"Domain"},"mutationType":null}}', $strSresult);
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testIntrospectionListArguments():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(meta::external::query::graphQL::transformation::introspection::tests::Domain2, $query);
  assertJsonStringsEqual('{"__schema":{"types":[{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"BigDecimal"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Boolean"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Date"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"DateTime"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[{"name":"legalNames","defaultValue":null,"type":{"kind":"LIST","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}}],"name":"firmByLegalNames","type":{"kind":"LIST","ofType":{"kind":"OBJECT","ofType":null,"name":"Firm"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Domain2"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"legalName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"employees","type":{"kind":"LIST","ofType":{"kind":"OBJECT","ofType":null,"name":"Person"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"isPublicEntity","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Boolean"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Firm"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Float"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"Int"},{"kind":"OBJECT","possibleTypes":[],"enumValues":[],"fields":[{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"id","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Int"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"firstName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"lastName","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"String"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"date","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"Date"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"dateTime","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"DateTime"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"strictDate","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"StrictDate"},"name":null}},{"isDeprecated":false,"deprecationReason":null,"args":[],"name":"decimal","type":{"kind":"NON_NULL","ofType":{"kind":"SCALAR","ofType":null,"name":"BigDecimal"},"name":null}}],"interfaces":[],"inputFields":[],"name":"Person"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"StrictDate"},{"kind":"SCALAR","possibleTypes":[],"enumValues":[],"fields":[],"interfaces":[],"inputFields":[],"name":"String"}],"directives":[{"locations":["FIELD"],"args":[],"name":"echo"},{"locations":["FIELD"],"args":[],"name":"totalCount"}],"queryType":{"name":"Domain2"},"mutationType":null}}', $strSresult);
}
