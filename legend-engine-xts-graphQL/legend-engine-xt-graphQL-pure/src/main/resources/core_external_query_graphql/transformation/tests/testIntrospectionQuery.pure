import meta::external::query::graphQL::transformation::introspection::tests::*;

Class meta::external::query::graphQL::transformation::introspection::tests::Firm
{
  legalName : String[1];
  employees : meta::external::query::graphQL::transformation::introspection::tests::Person[*];
  isPublicEntity: Boolean[1];
}

Class meta::external::query::graphQL::transformation::introspection::tests::Person
{
  id: Integer[1];
  firstName : String[1];
  lastName : String[1];
  date : Date[1];
  dateTime : DateTime[1];
  strictDate: StrictDate[1];
  decimal: Decimal[1];
}

Class meta::external::query::graphQL::transformation::introspection::tests::Domain extends meta::external::query::graphQL::transformation::introspection::BaseGraphQLType
{
  firmByLegalName(legalName : String[1])
  {
    Firm.all()->filter(f|$f.legalName == $legalName)->first()
  }: Firm[0..1];

}

Class meta::external::query::graphQL::transformation::introspection::tests::Domain2 extends meta::external::query::graphQL::transformation::introspection::BaseGraphQLType
{
  firmByLegalNames(legalNames : String[*])
  {
    Firm.all()->filter(f|$f.legalName->in($legalNames))
  }: Firm[*];
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testSimpleIntrospection():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(Firm, $query);
  assertJsonStringsEqual('{"__schema":{"queryType":{"name":"Firm"},"mutationType":null,"types":[{"fields":[],"interfaces":[],"enumValues":[],"name":"BigDecimal","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Boolean","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Date","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"DateTime","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"legalName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"LIST","ofType":{"name":"Person","kind":"OBJECT","ofType":null}},"name":"employees"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Boolean","kind":"SCALAR","ofType":null}},"name":"isPublicEntity"}],"interfaces":[],"enumValues":[],"name":"Firm","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Float","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Int","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Int","kind":"SCALAR","ofType":null}},"name":"id"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"firstName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"lastName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Date","kind":"SCALAR","ofType":null}},"name":"date"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"DateTime","kind":"SCALAR","ofType":null}},"name":"dateTime"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"StrictDate","kind":"SCALAR","ofType":null}},"name":"strictDate"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"BigDecimal","kind":"SCALAR","ofType":null}},"name":"decimal"}],"interfaces":[],"enumValues":[],"name":"Person","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"StrictDate","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"String","kind":"SCALAR","inputFields":[],"possibleTypes":[]}],"directives":[{"locations":["FIELD"],"args":[],"name":"echo"}]}}', $strSresult);
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testIntrospectionWithQualified():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(meta::external::query::graphQL::transformation::introspection::tests::Domain, $query);
  assertJsonStringsEqual('{"__schema":{"queryType":{"name":"Domain"},"mutationType":null,"types":[{"fields":[],"interfaces":[],"enumValues":[],"name":"BigDecimal","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Boolean","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Date","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"DateTime","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[{"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"legalName","defaultValue":null}],"isDeprecated":false,"deprecationReason":null,"type":{"name":"Firm","kind":"OBJECT","ofType":null},"name":"firmByLegalName"}],"interfaces":[],"enumValues":[],"name":"Domain","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"legalName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"LIST","ofType":{"name":"Person","kind":"OBJECT","ofType":null}},"name":"employees"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Boolean","kind":"SCALAR","ofType":null}},"name":"isPublicEntity"}],"interfaces":[],"enumValues":[],"name":"Firm","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Float","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Int","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Int","kind":"SCALAR","ofType":null}},"name":"id"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"firstName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"lastName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Date","kind":"SCALAR","ofType":null}},"name":"date"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"DateTime","kind":"SCALAR","ofType":null}},"name":"dateTime"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"StrictDate","kind":"SCALAR","ofType":null}},"name":"strictDate"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"BigDecimal","kind":"SCALAR","ofType":null}},"name":"decimal"}],"interfaces":[],"enumValues":[],"name":"Person","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"StrictDate","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"String","kind":"SCALAR","inputFields":[],"possibleTypes":[]}],"directives":[{"locations":["FIELD"],"args":[],"name":"echo"}]}}', $strSresult);
}

function <<test.Test>> meta::external::query::graphQL::transformation::introspection::tests::testIntrospectionListArguments():Boolean[1]
{
  let query = meta::external::query::graphQL::transformation::queryToPure::tests::buildIntrospectionQuery();
  let strSresult = meta::external::query::graphQL::transformation::introspection::graphQLIntrospectionQuery(meta::external::query::graphQL::transformation::introspection::tests::Domain2, $query);
  assertJsonStringsEqual('{"__schema":{"queryType":{"name":"Domain2"},"mutationType":null,"types":[{"fields":[],"interfaces":[],"enumValues":[],"name":"BigDecimal","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Boolean","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Date","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"DateTime","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[{"type":{"name":null,"kind":"LIST","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"legalNames","defaultValue":null}],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"LIST","ofType":{"name":"Firm","kind":"OBJECT","ofType":null}},"name":"firmByLegalNames"}],"interfaces":[],"enumValues":[],"name":"Domain2","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"legalName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"LIST","ofType":{"name":"Person","kind":"OBJECT","ofType":null}},"name":"employees"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Boolean","kind":"SCALAR","ofType":null}},"name":"isPublicEntity"}],"interfaces":[],"enumValues":[],"name":"Firm","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Float","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"Int","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Int","kind":"SCALAR","ofType":null}},"name":"id"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"firstName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"String","kind":"SCALAR","ofType":null}},"name":"lastName"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"Date","kind":"SCALAR","ofType":null}},"name":"date"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"DateTime","kind":"SCALAR","ofType":null}},"name":"dateTime"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"StrictDate","kind":"SCALAR","ofType":null}},"name":"strictDate"},{"args":[],"isDeprecated":false,"deprecationReason":null,"type":{"name":null,"kind":"NON_NULL","ofType":{"name":"BigDecimal","kind":"SCALAR","ofType":null}},"name":"decimal"}],"interfaces":[],"enumValues":[],"name":"Person","kind":"OBJECT","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"StrictDate","kind":"SCALAR","inputFields":[],"possibleTypes":[]},{"fields":[],"interfaces":[],"enumValues":[],"name":"String","kind":"SCALAR","inputFields":[],"possibleTypes":[]}],"directives":[{"locations":["FIELD"],"args":[],"name":"echo"}]}}', $strSresult);
}