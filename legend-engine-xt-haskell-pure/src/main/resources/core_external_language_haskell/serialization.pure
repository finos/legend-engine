import meta::external::language::haskell::metamodel::*;

function meta::external::language::haskell::format::toString(type:HaskellType[1]):String[1]
{
  $type->match([
    t:NamedTypeRef[1] | $t.name,
    a:Any[1] | $type.classifierGenericType.rawType->toOne()->toString()
  ])
}

function meta::external::language::haskell::format::toString(deriving:Deriving[1]):String[1]
{
  $deriving.types->map(t | $t->meta::external::language::haskell::format::toString())->makeString('(',', ',')');
}