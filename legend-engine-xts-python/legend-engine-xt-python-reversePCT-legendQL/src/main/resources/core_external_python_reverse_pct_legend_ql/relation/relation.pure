// Copyright 2025 Goldman Sachs
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import meta::pure::test::pct::reversePCT::framework::*;
import meta::external::python::reversePCT::legendQL::*;

function meta::external::python::reversePCT::legendQL::pythonLegendQLReversesEssentialRelation(): ReversesForSource[*]
{
  [
    // Ranking ---------------------------------
    meta::pure::functions::relation::tests::ntile::testOLAPWithPartitionAndOrderNTile_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,1,A\n'+
              '3,1,B\n'+
              '3,1,C\n'+
              '4,4,D\n'+
              '3,1,E\n'+
              '6,1,F\n'+
              '7,4,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~name->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::ntile($r, 2)})',
            '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", lambda r: [r.name.descending()]), ("other", lambda p, w, r: p.ntile(r, 2)))'+
            ')(csv_frame("id,grp,name\\n1,1,A\\n3,1,B\\n3,1,C\\n4,4,D\\n3,1,E\\n6,1,F\\n7,4,G\\n8,1,H\\n9,5,I\\n10,0,J"))'
        )
      ]
    ),
    
    meta::pure::functions::relation::tests::rank::testOLAPWithPartitionAndOrderRank_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '8,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::rank($w, $r)})',
            '(lambda frame: frame.window_extend(' +
              'frame.window(["grp"], lambda r: r.id.descending()), ("other", lambda p, w, r: p.rank(w, r)))' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n8,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))'
        )
      ]
    ),

    meta::pure::functions::relation::tests::rowNumber::testOLAPWithPartitionAndRowNumber_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '6,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::rowNumber($r)})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("other", lambda p, w, r: p.row_number(r)))' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')

      ]
    ),

    meta::pure::functions::relation::tests::denseRank::testOLAPWithPartitionAndOrderDenseRank_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '8,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::denseRank($w, $r)})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("other", lambda p, w, r: p.dense_rank(w,r)))' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n8,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    meta::pure::functions::relation::tests::percentRank::testOLAPWithPartitionAndOrderPercentRank_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,1,A\n'+
              '3,1,B\n'+
              '3,1,C\n'+
              '4,4,D\n'+
              '3,1,E\n'+
              '6,1,F\n'+
              '7,4,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::percentRank($w, $r)})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("other", lambda p, w, r: p.percent_rank(w,r)))' +
            ')(csv_frame("id,grp,name\\n1,1,A\\n3,1,B\\n3,1,C\\n4,4,D\\n3,1,E\\n6,1,F\\n7,4,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    meta::pure::functions::relation::tests::cumulativeDistribution::testOLAPWithPartitionAndOrderCummulativeDistribution_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '6,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::cumulativeDistribution($w, $r)->meta::pure::functions::math::round(2)})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("other", lambda p, w, r: round(p.cume_dist(w, r), 2)) )' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    meta::pure::functions::relation::tests::lag::testOLAPWithPartitionAndOrderWindowUsingLag_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '6,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::lag($r).name})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("newCol", lambda p, w, r: p.lag(r).name) )' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    meta::pure::functions::relation::tests::last::testOLAPWithPartitionAndOrderLastWindow_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '6,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::last($w, $r).id})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["id"], lambda r: r.id.descending()), ("newCol", lambda p, w, r: p.last(w,r).id) )' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    meta::pure::functions::relation::tests::first::testOLAPWithPartitionAndOrderFirstWindow_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '6,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::first($w, $r).name})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("other", lambda p, w, r: p.first(w,r).name) )' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    [
      meta::pure::functions::relation::tests::limit::testSimpleLimitShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::sort(~val->meta::pure::functions::relation::ascending())->meta::pure::functions::relation::limit(3)',
               '(lambda frame:' +
               '  frame.sort(["val"]).limit(3)' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::limit::testSimpleLimit_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,str\n'+
                        '1,a\n'+
                        '3,ewe\n'+
                        '4,qw\n'+
                        '5,wwe\n'+
                        '6,weq}#;\n'+
                        ' $t->meta::pure::functions::relation::sort(~val->meta::pure::functions::relation::ascending())->meta::pure::functions::relation::limit(3);\n'+
                        '',
               '(lambda frame:' +
               '  frame.sort(["val"]).limit(3)' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))'
               )      
        ]
      )

    ]->combine(),

    [
      meta::pure::functions::relation::tests::nth::testOLAPWithPartitionAndOrderNthWindow_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::nth($w, $r, 1).id})',
            '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("newCol", lambda p, w, r: p.nth(w,r,1).id) )' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::nth::testOLAPWithPartitionAndOrderNthWindow2_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::nth($w, $r, 2).id})',
             '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("newCol", lambda p, w, r: p.nth(w,r,2).id) )' +
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      )

    ]->combine(),

    [
      meta::pure::functions::relation::tests::slice::testSimpleSliceShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::sort(~val->meta::pure::functions::relation::ascending())->meta::pure::functions::relation::slice(1, 3)',
              '(lambda frame:' +
               '  frame.sort(["val"]).slice(1,3)' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::slice::testSimpleSlice_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                          'val,str\n'+
                          '1,a\n'+
                          '3,ewe\n'+
                          '4,qw\n'+
                          '5,wwe\n'+
                          '6,weq}#;\n'+
                          ' let t2 = $t->meta::pure::functions::relation::slice(1, 4);\n'+
                          ' $t2->meta::pure::functions::relation::slice(0, 2);\n'+
                          '',
              '(lambda frame:' +
               '  frame.slice(1,4).slice(0,2)' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      )
    ]->combine(),

    meta::pure::functions::relation::tests::lead::testOLAPWithPartitionAndOrderWindow_Function_1__Boolean_1_->testRev(
      [
        rev('|#TDS{\n'+
              'id,grp,name\n'+
              '1,2,A\n'+
              '2,1,B\n'+
              '3,3,C\n'+
              '4,4,D\n'+
              '5,2,E\n'+
              '6,1,F\n'+
              '7,3,G\n'+
              '8,1,H\n'+
              '9,5,I\n'+
              '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::lead($r).id})',
          '(lambda frame: frame.window_extend(' +
                  'frame.window(["grp"], lambda r: r.id.descending()), ("newCol", lambda p, w, r: p.lead(r).id) )' +
          ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
      ]
    ),

    [
      meta::pure::functions::relation::tests::drop::testSimpleDropShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::sort(~val->meta::pure::functions::relation::ascending())->meta::pure::functions::relation::drop(3)',
            '(lambda frame:' +
               '  frame.sort(["val"]).drop(3)' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::drop::testSimpleDrop_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,str\n'+
                        '1,a\n'+
                        '3,ewe\n'+
                        '4,qw\n'+
                        '5,wwe\n'+
                        '6,weq}#;\n'+
                        ' let t2 = $t->meta::pure::functions::relation::drop(2);\n'+
                        ' $t2->meta::pure::functions::relation::drop(1);\n'+
                        '',
               '(lambda frame:' +
               '  frame.drop(2).drop(1)' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      )

    ]->combine(),  

    [
      meta::pure::functions::relation::tests::sort::testSimpleSortShared_Function_1__Boolean_1_->testRev(
        [ 
          rev('|#TDS{\n'+
                'id,name\n'+
                '2,George\n'+
                '3,Pierre\n'+
                '1,Sachin\n'+
                '1,Neema\n'+
                '5,David\n'+
                '4,Alex\n'+
                '2,Thierry}#->meta::pure::functions::relation::sort(~id->meta::pure::functions::relation::ascending())',
              '(lambda frame:' +
               '  frame.sort(["id"])' +
               ')(csv_frame("id,name\\n2,George\\n3,Pierre\\n1,Sachin\\n1,Neema\\n5,David\\n4,Alex\\n2,Thierry"))'          
          ),

          rev('|#TDS{\n'+
                'id,name\n'+
                '2,George\n'+
                '3,Pierre\n'+
                '1,Sachin\n'+
                '1,Neema\n'+
                '5,David\n'+
                '4,Alex\n'+
                '2,Thierry}#->meta::pure::functions::relation::sort([~id->meta::pure::functions::relation::ascending(), ~name->meta::pure::functions::relation::ascending()])',
              '(lambda frame:' +
               '  frame.sort(["id","name"])' +
               ')(csv_frame("id,name\\n2,George\\n3,Pierre\\n1,Sachin\\n1,Neema\\n5,David\\n4,Alex\\n2,Thierry"))'          
          ),

          rev('|#TDS{\n'+
                'id,name\n'+
                '2,George\n'+
                '3,Pierre\n'+
                '1,Sachin\n'+
                '1,Neema\n'+
                '5,David\n'+
                '4,Alex\n'+
                '2,Thierry}#->meta::pure::functions::relation::sort([~id->meta::pure::functions::relation::descending(), ~name->meta::pure::functions::relation::ascending()])',
              '(lambda frame:' +
               '  frame.sort(lambda r: [r["id"].descending(), r["name"].ascending()])' +
               ')(csv_frame("id,name\\n2,George\\n3,Pierre\\n1,Sachin\\n1,Neema\\n5,David\\n4,Alex\\n2,Thierry"))'          
          )
        ]
      ),

      meta::pure::functions::relation::tests::sort::testSimpleSort_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [ 
          rev('|let t = #TDS{\n'+
                        'id,name\n'+
                        '2,George\n'+
                        '3,Pierre\n'+
                        '1,Sachin\n'+
                        '1,Neema\n'+
                        '5,David\n'+
                        '4,Alex\n'+
                        '2,Thierry}#;\n $t->meta::pure::functions::relation::sort(~id->meta::pure::functions::relation::ascending());\n',
              '(lambda frame:' +
               '  frame.sort(["id"])' +
               ')(csv_frame("id,name\\n2,George\\n3,Pierre\\n1,Sachin\\n1,Neema\\n5,David\\n4,Alex\\n2,Thierry"))'          
          ),

          rev('|let t = #TDS{\n'+
                        'id,name\n'+
                        '2,George\n'+
                        '3,Pierre\n'+
                        '1,Sachin\n'+
                        '1,Neema\n'+
                        '5,David\n'+
                        '4,Alex\n'+
                        '2,Thierry}#;\n $t->meta::pure::functions::relation::sort([~id->meta::pure::functions::relation::ascending(), ~name->meta::pure::functions::relation::ascending()]);\n',
              '(lambda frame:' +
               '  frame.sort(["id","name"])' +
               ')(csv_frame("id,name\\n2,George\\n3,Pierre\\n1,Sachin\\n1,Neema\\n5,David\\n4,Alex\\n2,Thierry"))'          
          ),

          rev('|let t = #TDS{\n'+
                        'id,name\n'+
                        '2,George\n'+
                        '3,Pierre\n'+
                        '1,Sachin\n'+
                        '1,Neema\n'+
                        '5,David\n'+
                        '4,Alex\n'+
                        '2,Thierry}#;\n'+
                        ' $t->meta::pure::functions::relation::sort([~id->meta::pure::functions::relation::descending(), ~name->meta::pure::functions::relation::ascending()]);\n'+
                    '',
              '(lambda frame:' +
               '  frame.sort(lambda r: [r["id"].descending(), r["name"].ascending()])' +
               ')(csv_frame("id,name\\n2,George\\n3,Pierre\\n1,Sachin\\n1,Neema\\n5,David\\n4,Alex\\n2,Thierry"))'          
          )

        ]
      )
    ]->combine(),

    [
      meta::pure::functions::relation::tests::extend::testSimpleExtendStrShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::extend(~name:c: (val:Integer, str:String)[1]|$c.str->meta::pure::functions::multiplicity::toOne() + $c.val->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString())',
            '(lambda frame:' +
               '  frame.extend(("name", lambda r: r.str + r.val.to_string()))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleExtendStr_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,str\n'+
                        '1,a\n'+
                        '3,ewe\n'+
                        '4,qw\n'+
                        '5,wwe\n'+
                        '6,weq}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~name:c: (val:Integer, str:String)[1]|$c.str->meta::pure::functions::multiplicity::toOne() + $c.val->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString());\n'+
                        '',
                '(lambda frame:' +
               '  frame.extend(("name", lambda r: r.str + r.val.to_string()))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleExtendInt_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::extend(~name:c: (val:Integer, str:String)[1]|$c.val->meta::pure::functions::multiplicity::toOne() + 1)',
            '(lambda frame:' +
               '  frame.extend(("name", lambda r: r.val + 1))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleExtendInt_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,str\n'+
                        '1,a\n'+
                        '3,ewe\n'+
                        '4,qw\n'+
                        '5,wwe\n'+
                        '6,weq}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~name:c: (val:Integer, str:String)[1]|$c.val->meta::pure::functions::multiplicity::toOne() + 1);\n'+
                        '',
               '(lambda frame:' +
               '  frame.extend(("name", lambda r: r.val + 1))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleExtendFloat_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,doub\n'+
                '1,1.2\n'+
                '3,2.3\n'+
                '4,4.2\n'+
                '5,4.2\n'+
                '6,4.5}#->meta::pure::functions::relation::extend(~name:c: (val:Integer, doub:Float)[1]|$c.doub->meta::pure::functions::multiplicity::toOne() + 1.0)',
            '(lambda frame:' +
               '  frame.extend(("name", lambda r: r.doub + 1.0))' +
               ')(csv_frame("val,doub\\n1,1.2\\n3,2.3\\n4,4.2\\n5,4.2\\n6,4.5"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleExtendFloat_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,doub\n'+
                        '1,1.2\n'+
                        '3,2.3\n'+
                        '4,4.2\n'+
                        '5,4.2\n'+
                        '6,4.5}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~name:c: (val:Integer, doub:Float)[1]|$c.doub->meta::pure::functions::multiplicity::toOne() + 1.0);\n'+
                        '',
              '(lambda frame:' +
               '  frame.extend(("name", lambda r: r.doub + 1.0))' +
               ')(csv_frame("val,doub\\n1,1.2\\n3,2.3\\n4,4.2\\n5,4.2\\n6,4.5"))')        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleMultipleColumns_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::extend(~[name:c: (val:Integer, str:String)[1]|$c.val->meta::pure::functions::multiplicity::toOne() + 1,other:x: (val:Integer, str:String)[1]|$x.str->meta::pure::functions::multiplicity::toOne() + \'_ext\'])',
               '(lambda frame:' +
               '  frame.extend([("name", lambda r: r.val + 1),("other", lambda r: r.str + \'_ext\')])' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testSimpleMultipleColumns_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,str\n'+
                        '1,a\n'+
                        '3,ewe\n'+
                        '4,qw\n'+
                        '5,wwe\n'+
                        '6,weq}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~[name:c: (val:Integer, str:String)[1]|$c.val->meta::pure::functions::multiplicity::toOne() + 1,other:x: (val:Integer, str:String)[1]|$x.str->meta::pure::functions::multiplicity::toOne() + \'_ext\']);\n'+
                        '',
               '(lambda frame:' +
               '  frame.extend([("name", lambda r: r.val + 1),("other", lambda r: r.str + \'_ext\')])' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggNoWindow_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~newCol:c: (id:Integer, grp:Integer, name:String)[1]|$c.id:y: Integer[*]|$y->plus())',
               '(lambda frame:' +
               '  frame.extend(("newCol", lambda r: r.id , lambda c : c.sum()))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggNoWindow_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,name\n'+
                        '1,2,A\n'+
                        '2,1,B\n'+
                        '3,3,C\n'+
                        '4,4,D\n'+
                        '5,2,E\n'+
                        '6,1,F\n'+
                        '7,3,G\n'+
                        '8,1,H\n'+
                        '9,5,I\n'+
                        '10,0,J}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~newCol:c: (id:Integer, grp:Integer, name:String)[1]|$c.id:y: Integer[*]|$y->plus());\n'+
                        '',
               '(lambda frame:' +
               '  frame.extend(("newCol", lambda r: r.id , lambda c : c.sum()))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggNoWindowMultipleColums_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~[newCol:c: (id:Integer, grp:Integer, name:String)[1]|$c.id:y: Integer[*]|$y->plus(),other:c: (id:Integer, grp:Integer, name:String)[1]|$c.grp:y: Integer[*]|$y->plus()])',
               '(lambda frame:' +
               '  frame.extend([("newCol", lambda r: r.id , lambda c: c.sum()),("other", lambda r: r.grp , lambda c: c.sum())])' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggNoWindowMultipleColums_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,name\n'+
                        '1,2,A\n'+
                        '2,1,B\n'+
                        '3,3,C\n'+
                        '4,4,D\n'+
                        '5,2,E\n'+
                        '6,1,F\n'+
                        '7,3,G\n'+
                        '8,1,H\n'+
                        '9,5,I\n'+
                        '10,0,J}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~[newCol:c: (id:Integer, grp:Integer, name:String)[1]|$c.id:y: Integer[*]|$y->plus(),other:c: (id:Integer, grp:Integer, name:String)[1]|$c.grp:y: Integer[*]|$y->plus()]);\n'+
                        '',
               '(lambda frame:' +
               '  frame.extend([("newCol", lambda r: r.id , lambda c: c.sum()),("other", lambda r: r.grp , lambda c: c.sum())])' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),
      meta::pure::functions::relation::tests::extend::testOLAPAggWithPartitionWindow_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus())',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", []), ("newCol", lambda p, w, r: r.id , lambda c: c.sum()))'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggWithPartitionWindowMultipleColumns_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus(),other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.grp}:y: Integer[*]|$y->plus()])',
            '(lambda frame: frame.window_extend(' +
             'frame.window( "grp", []), [("newCol", lambda p, w, r: r.id , lambda c: c.sum()),("other", lambda p, w, r: r.grp , lambda c: c.sum())])'+
            ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggWithPartitionWindowMultipleColumns_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,name\n'+
                        '1,2,A\n'+
                        '2,1,B\n'+
                        '3,3,C\n'+
                        '4,4,D\n'+
                        '5,2,E\n'+
                        '6,1,F\n'+
                        '7,3,G\n'+
                        '8,1,H\n'+
                        '9,5,I\n'+
                        '10,0,J}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus(),other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.grp}:y: Integer[*]|$y->plus()]);\n'+
                        '',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", []), [("newCol", lambda p, w, r: r.id , lambda c: c.sum()),("other", lambda p, w, r: r.grp , lambda c: c.sum())])'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggWithPartitionAndOrderWindowMultipleColumns_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.name}:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'),other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus()])',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", lambda r: r.id.descending()), [("newCol", lambda p, w, r: r.name , lambda c: c.join("")),("other", lambda p, w, r: r.id , lambda c: c.sum())])'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggWithPartitionAndOrderWindowMultipleColumns_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,name\n'+
                        '1,2,A\n'+
                        '2,1,B\n'+
                        '3,3,C\n'+
                        '4,4,D\n'+
                        '5,2,E\n'+
                        '6,1,F\n'+
                        '7,3,G\n'+
                        '8,1,H\n'+
                        '9,5,I\n'+
                        '10,0,J}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.name}:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'),other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus()]);\n'+
                        '',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", lambda r: r.id.descending()), [("newCol", lambda p, w, r: r.name , lambda c: c.join("")),("other", lambda p, w, r: r.id , lambda c: c.sum())])'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPWithPartitionAndMultipleOrderWindowMultipleColumns_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name,height\n'+
                '1,2,A,11\n'+
                '2,1,B,12\n'+
                '3,3,C,12\n'+
                '4,3,B,11\n'+
                '5,2,B,13\n'+
                '6,1,C,12\n'+
                '7,3,A,13\n'+
                '8,1,B,14\n'+
                '9,1,C,11\n'+
                '10,2,D,11}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over([~name->meta::pure::functions::relation::ascending(), ~height->meta::pure::functions::relation::ascending()]), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String, height:Integer)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String, height:Integer)>[1], r: (id:Integer, grp:Integer, name:String, height:Integer)[1]|$p->meta::pure::functions::relation::lead($r).id},other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String, height:Integer)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String, height:Integer)>[1], r: (id:Integer, grp:Integer, name:String, height:Integer)[1]|$p->meta::pure::functions::relation::first($w, $r).name}])',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", ["name","height"]), [("newCol", lambda p, w, r: p.lead(r).id),("other", lambda p, w, r: p.first(w,r).name)])'+
              ')(csv_frame("id,grp,name,height\\n1,2,A,11\\n2,1,B,12\\n3,3,C,12\\n4,3,B,11\\n5,2,B,13\\n6,1,C,12\\n7,3,A,13\\n8,1,B,14\\n9,1,C,11\\n10,2,D,11"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPWithPartitionAndMultipleOrderWindowMultipleColumnsWithFilter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name,height\n'+
                '1,2,A,11\n'+
                '2,1,B,12\n'+
                '3,3,C,12\n'+
                '4,3,B,11\n'+
                '5,2,B,13\n'+
                '6,1,C,12\n'+
                '7,3,A,13\n'+
                '8,1,B,14\n'+
                '9,1,C,11\n'+
                '10,2,D,11}#->meta::pure::functions::relation::filter(x: (id:Integer, grp:Integer, name:String, height:Integer)[1]|$x.id < 9)->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over([~name->meta::pure::functions::relation::ascending(), ~height->meta::pure::functions::relation::ascending()]), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String, height:Integer)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String, height:Integer)>[1], r: (id:Integer, grp:Integer, name:String, height:Integer)[1]|$p->meta::pure::functions::relation::lead($r).id},other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String, height:Integer)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String, height:Integer)>[1], r: (id:Integer, grp:Integer, name:String, height:Integer)[1]|$p->meta::pure::functions::relation::first($w, $r).name}])',
            '(lambda frame: frame.window_extend(' +
            'frame.window( "grp", ["name","height"]), [("newCol", lambda p, w, r: p.lead(r).id),("other", lambda p, w, r: p.first(w,r).name)])'+
            ')(csv_frame("id,grp,name,height\\n1,2,A,11\\n2,1,B,12\\n3,3,C,12\\n4,3,B,11\\n5,2,B,13\\n6,1,C,12\\n7,3,A,13\\n8,1,B,14\\n9,1,C,11\\n10,2,D,11").filter(lambda x : x.id < 9))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPWithPartitionAndOrderWindowMultipleColumns_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::lead($r).id},other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::first($w, $r).name}])',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", lambda r : r.id.descending()), [("newCol", lambda p, w, r: p.lead(r).id),("other", lambda p, w, r: p.first(w,r).name)])'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPWithPartitionAndOrderWindowMultipleColumns_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                          'id,grp,name\n'+
                          '1,2,A\n'+
                          '2,1,B\n'+
                          '3,3,C\n'+
                          '4,4,D\n'+
                          '5,2,E\n'+
                          '6,1,F\n'+
                          '7,3,G\n'+
                          '8,1,H\n'+
                          '9,5,I\n'+
                          '10,0,J}#;\n'+
                          ' $t->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::lead($r).id},other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$p->meta::pure::functions::relation::first($w, $r).name}]);\n'+
                          '',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", lambda r : r.id.descending()), [("newCol", lambda p, w, r: p.lead(r).id),("other", lambda p, w, r: p.first(w,r).name)])'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggNoWindowChainedWithSimple_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~newCol:c: (id:Integer, grp:Integer, name:String)[1]|$c.id:y: Integer[*]|$y->plus())->meta::pure::functions::relation::extend(~other:x: (id:Integer, grp:Integer, name:String, newCol:Integer)[1]|meta::pure::functions::math::floor($x.newCol->meta::pure::functions::multiplicity::toOne() / $x.id->meta::pure::functions::multiplicity::toOne()))',
            '(lambda frame:' +
               '  frame.extend([("newCol", lambda r: r.id, lambda c : c.sum())]).extend(("other", lambda r : math.floor(r.newCol / r.id)))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))') 
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggNoWindowChainedWithSimple_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,name\n'+
                        '1,2,A\n'+
                        '2,1,B\n'+
                        '3,3,C\n'+
                        '4,4,D\n'+
                        '5,2,E\n'+
                        '6,1,F\n'+
                        '7,3,G\n'+
                        '8,1,H\n'+
                        '9,5,I\n'+
                        '10,0,J}#;\n'+
                        ' let t2 = $t->meta::pure::functions::relation::extend(~newCol:c: (id:Integer, grp:Integer, name:String)[1]|$c.id:y: Integer[*]|$y->plus());\n'+
                        ' $t2->meta::pure::functions::relation::extend(~other:x: (id:Integer, grp:Integer, name:String, newCol:Integer)[1]|meta::pure::functions::math::floor($x.newCol->meta::pure::functions::multiplicity::toOne() / $x.id->meta::pure::functions::multiplicity::toOne()));\n'+
                        '',
               '(lambda frame:' +
               '  frame.extend([("newCol", lambda r: r.id , lambda c: c.sum())]).extend(("other", lambda r : math.floor(r.newCol / r.id)))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))') 
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPWithMultiplePartitionsAndOrderWindowMultipleColumns_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,grp2,name\n'+
                '1,2,2,A\n'+
                '2,1,1,B\n'+
                '3,3,3,C\n'+
                '4,4,4,D\n'+
                '5,2,2,E\n'+
                '6,1,2,F\n'+
                '7,3,3,G\n'+
                '8,1,1,H\n'+
                '9,5,5,I\n'+
                '10,0,0,J}#->meta::pure::functions::relation::extend(~[grp,grp2]->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], r: (id:Integer, grp:Integer, grp2:Integer, name:String)[1]|$p->meta::pure::functions::relation::lead($r).id},other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], r: (id:Integer, grp:Integer, grp2:Integer, name:String)[1]|$p->meta::pure::functions::relation::first($w, $r).name}])',
             '(lambda frame: frame.window_extend(' +
             'frame.window(["grp","grp2"], lambda r : r.id.descending()), [("newCol", lambda p, w, r: p.lead(r).id),("other", lambda p, w, r: p.first(w,r).name)])'+
             ')(csv_frame("id,grp,grp2,name\\n1,2,2,A\\n2,1,1,B\\n3,3,3,C\\n4,4,4,D\\n5,2,2,E\\n6,1,2,F\\n7,3,3,G\\n8,1,1,H\\n9,5,5,I\\n10,0,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPWithMultiplePartitionsAndOrderWindowMultipleColumns_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,grp2,name\n'+
                        '1,2,2,A\n'+
                        '2,1,1,B\n'+
                        '3,3,3,C\n'+
                        '4,4,4,D\n'+
                        '5,2,2,E\n'+
                        '6,1,2,F\n'+
                        '7,3,3,G\n'+
                        '8,1,1,H\n'+
                        '9,5,5,I\n'+
                        '10,0,0,J}#;\n'+
                        ' $t->meta::pure::functions::relation::extend(~[grp,grp2]->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~[newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], r: (id:Integer, grp:Integer, grp2:Integer, name:String)[1]|$p->meta::pure::functions::relation::lead($r).id},other:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, grp2:Integer, name:String)>[1], r: (id:Integer, grp:Integer, grp2:Integer, name:String)[1]|$p->meta::pure::functions::relation::first($w, $r).name}]);\n'+
                        '',
             '(lambda frame: frame.window_extend(' +
             'frame.window(["grp","grp2"], lambda r : r.id.descending()), [("newCol", lambda p, w, r: p.lead(r).id),("other", lambda p, w, r: p.first(w,r).name)])'+
             ')(csv_frame("id,grp,grp2,name\\n1,2,2,A\\n2,1,1,B\\n3,3,3,C\\n4,4,4,D\\n5,2,2,E\\n6,1,2,F\\n7,3,3,G\\n8,1,1,H\\n9,5,5,I\\n10,0,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggIntegerWithPartitionAndOrderWindow_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus())',
          '(lambda frame: frame.window_extend(' +
             'frame.window(["grp"], lambda r : r.id.descending()), [("newCol", lambda p, w, r: r.id , lambda c:c.sum())])'+
           ')(csv_frame("\\nid,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggIntegerWithPartitionAndOrderWindow_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                            'id,grp,name\n'+
                            '1,2,A\n'+
                            '2,1,B\n'+
                            '3,3,C\n'+
                            '4,4,D\n'+
                            '5,2,E\n'+
                            '6,1,F\n'+
                            '7,3,G\n'+
                            '8,1,H\n'+
                            '9,5,I\n'+
                            '10,0,J}#;\n'+
                            ' $t->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus());\n'+
                            '',
          '(lambda frame: frame.window_extend(' +
             'frame.window(["grp"], lambda r : r.id.descending()), [("newCol", lambda p, w, r: r.id , lambda c:c.sum())])'+
           ')(csv_frame("\\nid,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggStringWithPartitionAndOrderWindow_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,name\n'+
                '1,2,A\n'+
                '2,1,B\n'+
                '3,3,C\n'+
                '4,4,D\n'+
                '5,2,E\n'+
                '6,1,F\n'+
                '7,3,G\n'+
                '8,1,H\n'+
                '9,5,I\n'+
                '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.name}:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'))',
          '(lambda frame: frame.window_extend(' +
             'frame.window(["grp"], lambda r : r.id.descending()), [("newCol", lambda p, w, r: r.name, lambda c: c.join(\'\'))])'+
           ')(csv_frame("\\nid,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::extend::testOLAPAggStringWithPartitionAndOrderWindow_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                            'id,grp,name\n'+
                            '1,2,A\n'+
                            '2,1,B\n'+
                            '3,3,C\n'+
                            '4,4,D\n'+
                            '5,2,E\n'+
                            '6,1,F\n'+
                            '7,3,G\n'+
                            '8,1,H\n'+
                            '9,5,I\n'+
                            '10,0,J}#;\n'+
                            ' $t->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(~id->meta::pure::functions::relation::descending()), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.name}:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'));\n'+
                            '',
          '(lambda frame: frame.window_extend(' +
             'frame.window(["grp"], lambda r : r.id.descending()), [("newCol", lambda p, w, r: r.name, lambda c: c.join(\'\'))])'+
           ')(csv_frame("\\nid,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      )

    ]->combine(),
    [ // Filter --------
      meta::pure::functions::relation::tests::filter::testSimpleFilterShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val\n'+
                '1\n'+
                '3\n'+
                '4}#->meta::pure::functions::relation::filter(x: (val:Integer)[1]|$x.val > 1)',
              '(lambda frame:' +
               '  frame.filter((lambda x: x.val > 1))' +
               ')(csv_frame("val\\n1\\n3\\n4"))')
        ]
      ),
      
      meta::pure::functions::relation::tests::filter::testSimpleFilter_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let a = #TDS{\n'+
                          'val\n'+
                          '1\n'+
                          '3\n'+
                          '4\n'+
                          '5}#;\n'+
                          ' let b = $a->meta::pure::functions::relation::filter(x: (val:Integer)[1]|$x.val > 3);\n'+
                          ' $b->meta::pure::functions::relation::filter(x: (val:Integer)[1]|$x.val > 4);\n'+
                          '',
              '(lambda frame:' +
               '  frame.filter((lambda x: x.val > 3)).filter((lambda x: x.val > 4) )' +
               ')(csv_frame("val\\n1\\n3\\n4\\n5"))')
        ]
      )
    ]->combine(),
    // Transformation ---------------------
    [
      // AsOfJoin --------------------
      meta::pure::functions::relation::tests::asOfJoin::testSimpleAsOfJoin_Function_1__Boolean_1_->testRev(
        [
          rev('|$tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() > $y.time2->meta::pure::functions::multiplicity::toOne()})',
                        '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),(lambda x, y: x.time > y.time2))' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))'),

          rev('|$tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() < $y.time2->meta::pure::functions::multiplicity::toOne()})',
                        '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),(lambda x, y: x.time < y.time2))' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))')
        ]
      ),

      meta::pure::functions::relation::tests::asOfJoin::testSimpleAsOfJoin_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let tds1 = #TDS{\n'+
                  'key,time,value\n'+
                  '1,2000-10-25T06:30:00Z,5000\n'+
                  '1,2000-10-25T06:31:00Z,4000\n'+
                  '3,2000-10-25T06:32:00Z,3000\n'+
                  '4,2000-10-25T06:33:00Z,1200\n'+
                  '5,2000-10-25T06:34:00Z,3200\n'+
                  '6,2000-10-25T06:35:00Z,4300}#;\n'+
                  ' let tds2 = #TDS{\n'+
                  'key2,time2,value2\n'+
                  '2,2000-10-25T06:31:20Z,3000\n'+
                  '1,2000-10-25T06:30:10Z,2000\n'+
                  '4,2000-10-25T06:33:40Z,1400\n'+
                  '3,2000-10-25T06:32:30Z,3200\n'+
                  '6,2000-10-25T06:35:10Z,2900\n'+
                  '5,2000-10-25T06:34:50Z,3200}#;\n'+
                  ' $tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() > $y.time2->meta::pure::functions::multiplicity::toOne()});\n'+
                  '',
               '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),(lambda x, y: x.time > y.time2))' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))'),
            rev('|let tds1 = #TDS{\n'+
                'key,time,value\n'+
                '1,2000-10-25T06:30:00Z,5000\n'+
                '1,2000-10-25T06:31:00Z,4000\n'+
                '3,2000-10-25T06:32:00Z,3000\n'+
                '4,2000-10-25T06:33:00Z,1200\n'+
                '5,2000-10-25T06:34:00Z,3200\n'+
                '6,2000-10-25T06:35:00Z,4300}#;\n'+
                ' let tds2 = #TDS{\n'+
                'key2,time2,value2\n'+
                '2,2000-10-25T06:31:20Z,3000\n'+
                '1,2000-10-25T06:30:10Z,2000\n'+
                '4,2000-10-25T06:33:40Z,1400\n'+
                '3,2000-10-25T06:32:30Z,3200\n'+
                '6,2000-10-25T06:35:10Z,2900\n'+
                '5,2000-10-25T06:34:50Z,3200}#;\n'+
                ' $tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() < $y.time2->meta::pure::functions::multiplicity::toOne()});\n'+
                '',
               '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),(lambda x, y: x.time < y.time2))' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))')
        ]
      ),

      meta::pure::functions::relation::tests::asOfJoin::testAsOfJoinWithKeyMatch_Function_1__Boolean_1_->testRev(
        [
          rev('|$tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() > $y.time2->meta::pure::functions::multiplicity::toOne()}, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.key->meta::pure::functions::multiplicity::toOne() == $y.key2->meta::pure::functions::multiplicity::toOne()})',
                '(lambda frame:' +
               'frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),lambda x, y: x.time > y.time2 , lambda x, y: x.key == y.key2)' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))'),
          rev('|$tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() < $y.time2->meta::pure::functions::multiplicity::toOne()}, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.key->meta::pure::functions::multiplicity::toOne() == $y.key2->meta::pure::functions::multiplicity::toOne()})',
               '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),lambda x, y: x.time < y.time2 , lambda x, y: x.key == y.key2)' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))')

        ]
      ),

      meta::pure::functions::relation::tests::asOfJoin::testAsOfJoinWithKeyMatch_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let tds1 = #TDS{\n'+
                  'key,time,value\n'+
                  '1,2000-10-25T06:30:00Z,5000\n'+
                  '1,2000-10-25T06:31:00Z,4000\n'+
                  '3,2000-10-25T06:32:00Z,3000\n'+
                  '4,2000-10-25T06:33:00Z,1200\n'+
                  '5,2000-10-25T06:34:00Z,3200\n'+
                  '6,2000-10-25T06:35:00Z,4300}#;\n'+
                  ' let tds2 = #TDS{\n'+
                  'key2,time2,value2\n'+
                  '2,2000-10-25T06:31:20Z,3000\n'+
                  '1,2000-10-25T06:30:10Z,2000\n'+
                  '4,2000-10-25T06:33:40Z,1400\n'+
                  '3,2000-10-25T06:32:30Z,3200\n'+
                  '3,2000-10-25T06:33:30Z,3200\n'+
                  '3,2000-10-25T06:34:30Z,3200\n'+
                  '6,2000-10-25T06:35:10Z,2900\n'+
                  '6,2000-10-25T06:35:50Z,2900\n'+
                  '5,2000-10-25T06:34:50Z,3200}#;\n'+
                  ' $tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() > $y.time2->meta::pure::functions::multiplicity::toOne()}, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.key->meta::pure::functions::multiplicity::toOne() == $y.key2->meta::pure::functions::multiplicity::toOne()});\n'+
                  '',
               '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),lambda x, y: x.time > y.time2 , lambda x, y: x.key == y.key2)' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))'),
            
            rev('|let tds1 = #TDS{\n'+
                    'key,time,value\n'+
                    '1,2000-10-25T06:30:00Z,5000\n'+
                    '1,2000-10-25T06:31:00Z,4000\n'+
                    '3,2000-10-25T06:32:00Z,3000\n'+
                    '4,2000-10-25T06:33:00Z,1200\n'+
                    '5,2000-10-25T06:34:00Z,3200\n'+
                    '6,2000-10-25T06:35:00Z,4300}#;\n'+
                    ' let tds2 = #TDS{\n'+
                    'key2,time2,value2\n'+
                    '2,2000-10-25T06:31:20Z,3000\n'+
                    '1,2000-10-25T06:30:10Z,2000\n'+
                    '4,2000-10-25T06:33:40Z,1400\n'+
                    '3,2000-10-25T06:32:30Z,3200\n'+
                    '3,2000-10-25T06:33:30Z,3200\n'+
                    '3,2000-10-25T06:34:30Z,3200\n'+
                    '6,2000-10-25T06:35:10Z,2900\n'+
                    '6,2000-10-25T06:35:50Z,2900\n'+
                    '5,2000-10-25T06:34:50Z,3200}#;\n'+
                ' $tds1->meta::pure::functions::relation::asOfJoin($tds2, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.time->meta::pure::functions::multiplicity::toOne() < $y.time2->meta::pure::functions::multiplicity::toOne()}, {x: (key:Integer, time:Date, value:Integer)[1], y: (key2:Integer, time2:Date, value2:Integer)[1]|$x.key->meta::pure::functions::multiplicity::toOne() == $y.key2->meta::pure::functions::multiplicity::toOne()});\n'+
                '',
               '(lambda frame:' +
               '  frame.as_of_join(csv_frame("key2,time2,value2\\n2,2000-10-25T06:31:20Z,3000\\n1,2000-10-25T06:30:10Z,2000\\n4,2000-10-25T06:33:40Z,1400\\n3,2000-10-25T06:32:30Z,3200\\n6,2000-10-25T06:35:10Z,2900\\n5,2000-10-25T06:34:50Z,3200"),lambda x, y: x.time < y.time2 , lambda x, y: x.key == y.key2)' +
               ')(csv_frame("key,time,value\\n1,2000-10-25T06:30:00Z,5000\\n1,2000-10-25T06:31:00Z,4000\\n3,2000-10-25T06:32:00Z,3000\\n4,2000-10-25T06:33:00Z,1200\\n5,2000-10-25T06:34:00Z,3200\\n6,2000-10-25T06:35:00Z,4300"))')
        ]
      )
    ]-> combine(),
    [
      meta::pure::functions::relation::tests::concatenate::testSimpleConcatenateShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw}#->meta::pure::functions::relation::concatenate(#TDS{\n'+
                'val,str\n'+
                '5,qwea\n'+
                '6,eeewe\n'+
                '7,qqwew}#)',
              '(lambda frame:' +
               '  frame.concatenate(csv_frame("val,str\\n5,qwea\\n6,eeewe\\n7,qqwew"))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw"))')
        ]
      ),

      meta::pure::functions::relation::tests::concatenate::testSimpleConcatenate_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let a = #TDS{\n'+
                  'val,str\n'+
                  '1,a\n'+
                  '3,ewe\n'+
                  '4,qw}#;\n'+
                  ' let b = #TDS{\n'+
                  'val,str\n'+
                  '5,qwea\n'+
                  '6,eeewe\n'+
                  '7,qqwew}#;\n'+
                  ' let c = $a->meta::pure::functions::relation::concatenate($b);\n'+
                  ' $c->meta::pure::functions::relation::concatenate($b);\n'+
                  '',
                '(lambda frame:' +
               '  frame.concatenate(csv_frame("val,str\\n5,qwea\\n6,eeewe\\n7,qqwew")).concatenate(csv_frame("val,str\\n5,qwea\\n6,eeewe\\n7,qqwew"))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw"))')
        ]
      )
    ]->combine(),

    [
      meta::pure::functions::relation::tests::distinct::testDistinctAll_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '1,qw\n'+
                '5,weq\n'+
                '5,weq}#->meta::pure::functions::relation::distinct()',
            '(lambda frame:' +
            '  frame.distinct()' +
            ')(csv_frame("val,str\\n1,a\\n3,ewe\\n1,qw\\n5,weq\\n5,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::distinct::testDistinctAll_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                  'val,str\n'+
                  '1,a\n'+
                  '3,ewe\n'+
                  '1,qw\n'+
                  '5,weq\n'+
                  '5,weq}#;\n'+
                  ' $t->meta::pure::functions::relation::distinct();\n'+
                  '',
               '(lambda frame:' +
               '  frame.distinct()' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n1,qw\\n5,weq\\n5,weq"))')
        ]
      )
    ]->combine(),

    [
      meta::pure::functions::relation::tests::rename::testSimpleRenameShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str\n'+
                '1,a\n'+
                '3,ewe\n'+
                '4,qw\n'+
                '5,wwe\n'+
                '6,weq}#->meta::pure::functions::relation::rename(~str, ~newStr)',
            '(lambda frame:' +
            '  frame.rename(lambda r : (r.str , \'newStr\'))' +
            ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::rename::testSimpleRename_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                          'val,str\n'+
                          '1,a\n'+
                          '3,ewe\n'+
                          '4,qw\n'+
                          '5,wwe\n'+
                          '6,weq}#;\n'+
                          ' $t->meta::pure::functions::relation::rename(~str, ~newStr);\n'+
                          '',
               '(lambda frame:' +
               '  frame.rename(lambda r : (r.str , \'newStr\'))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      )
    ]->combine(),
    [
      meta::pure::functions::relation::tests::select::testMultiColsSelectShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str,other\n'+
                '1,a,a\n'+
                '3,ewe,b\n'+
                '4,qw,c\n'+
                '5,wwe,d\n'+
                '6,weq,e}#->meta::pure::functions::relation::select(~[val,other])',
               '(lambda frame:' +
               '  frame.select(lambda r: [r.val, r.other])' +
               ')(csv_frame("val,str,other\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e"))')
        ]
      ),

      meta::pure::functions::relation::tests::select::testMultiColsSelect_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                          'val,str,other\n'+
                          '1,a,a\n'+
                          '3,ewe,b\n'+
                          '4,qw,c\n'+
                          '5,wwe,d\n'+
                          '6,weq,e}#;\n'+
                          ' $t->meta::pure::functions::relation::select(~[val,other]);\n'+
                          '',
               '(lambda frame:' +
               '  frame.select(lambda r: [r.val, r.other])' +
               ')(csv_frame("val,str,other\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e"))')
        ]
      ),

      meta::pure::functions::relation::tests::select::testSingleColSelectShared_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str,other\n'+
                  '1,a,a\n'+
                  '3,ewe,b\n'+
                  '4,qw,c\n'+
                  '5,wwe,d\n'+
                  '6,weq,e}#->meta::pure::functions::relation::select(~str)',
              '(lambda frame:' +
               '  frame.select(lambda r: r.str)' +
               ')(csv_frame("val,str,other\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e"))')
        ]
      ),

      meta::pure::functions::relation::tests::select::testSingleColSelect_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                          'val,str,other\n'+
                          '1,a,a\n'+
                          '3,ewe,b\n'+
                          '4,qw,c\n'+
                          '5,wwe,d\n'+
                          '6,weq,e}#;\n'+
                          ' $t->meta::pure::functions::relation::select(~str);\n'+
                          '',
               '(lambda frame:' +
               '  frame.select(lambda r: r.str)' +
               ')(csv_frame("val,str,other\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e"))')
        ]
      ),

      meta::pure::functions::relation::tests::select::testSingleSelectWithQuotedColumn_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str,otherkind\n'+
                  '1,a,a\n'+
                  '3,ewe,b\n'+
                  '4,qw,c\n'+
                  '5,wwe,d\n'+
                  '6,weq,e}#->meta::pure::functions::relation::select(~\'other kind\')',
              '(lambda frame:' +
              '  frame.select(lambda r: r["other kind"])' +
              ')(csv_frame("val,str,other kind\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e"))')
        ]
      ),

      meta::pure::functions::relation::tests::select::testSingleSelectWithQuotedColumn_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'val,str,otherkind\n'+
                        '1,a,a\n'+
                        '3,ewe,b\n'+
                        '4,qw,c\n'+
                        '5,wwe,d\n'+
                        '6,weq,e}#;\n'+
                        ' $t->meta::pure::functions::relation::select(~\'other kind\');\n'+
                        '',
               '(lambda frame:' +
               '  frame.select(lambda r: r["other kind"])' +
               ')(csv_frame("val,str,other kind\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e"))')
        ]
      ), 
      meta::pure::functions::relation::tests::select::testSelectAll_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'val,str,other\n'+
                '1,a,a\n'+
                '3,ewe,b\n'+
                '4,qw,c\n'+
                '5,wwe,d\n'+
                '6,weq,e}#->meta::pure::functions::relation::select()',
            'csv_frame("val,str,other\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e")')
        ]
      ),

      meta::pure::functions::relation::tests::select::testSelectAll_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                  'val,str,other\n'+
                  '1,a,a\n'+
                  '3,ewe,b\n'+
                  '4,qw,c\n'+
                  '5,wwe,d\n'+
                  '6,weq,e}#;\n'+
                  ' $t->meta::pure::functions::relation::select();\n'+
                  '',
                        'csv_frame("val,str,other\\n1,a,a\\n3,ewe,b\\n4,qw,c\\n5,wwe,d\\n6,weq,e")')
        ]
      )
    ]->combine(),
    [ 
      // Group By ---------------
      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_SingleSingle_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::groupBy(~grp, ~newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'))',
              '(lambda frame:' +
               '  frame.group_by(grouping_columns=["grp"], aggregate_specifications=("newCol", lambda r: r.name, lambda c: c.join(\'\')))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_SingleSingle_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                        'id,grp,name\n'+
                        '1,2,A\n'+
                        '2,1,B\n'+
                        '3,3,C\n'+
                        '4,4,D\n'+
                        '5,2,E\n'+
                        '6,1,F\n'+
                        '7,3,G\n'+
                        '8,1,H\n'+
                        '9,5,I\n'+
                        '10,0,J}#;\n'+
                        ' $t->meta::pure::functions::relation::groupBy(~grp, ~newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'));\n'+
                        '',
               '(lambda frame:' +
               '  frame.group_by(["grp"], ("newCol", lambda r: r.name, lambda c: c.join(\'\')))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_MultipleSingle_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::groupBy(~[grp], ~newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'))',
               '(lambda frame:' +
               '  frame.group_by(grouping_columns=["grp"], aggregate_specifications=("newCol", lambda r: r.name, lambda c: c.join(\'\')))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_MultipleSingle_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#;\n'+
                  ' $t->meta::pure::functions::relation::groupBy(~[grp], ~newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'));\n'+
                  '',
               '(lambda frame:' +
               '  frame.group_by(["grp"], ("newCol", lambda r: r.name, lambda c: c.join(\'\')))' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_SingleMultiple_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::groupBy(~grp, ~[newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'),YoCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.id:y: Integer[*]|$y->plus()])',
                '(lambda frame:' +
               '  frame.group_by(grouping_columns=["grp"], aggregate_specifications=[("newCol", lambda r: r.name, lambda c: c.join(\'\')), ("YoCol", lambda r: r.id, lambda c: c.sum())])' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_SingleMultiple_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#;\n'+
                  ' $t->meta::pure::functions::relation::groupBy(~grp, ~[newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'),YoCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.id:y: Integer[*]|$y->plus()]);\n'+
                  '',
                '(lambda frame:' +
               '  frame.group_by(["grp"], [("newCol", lambda r: r.name, lambda c: c.join(\'\')), ("YoCol", lambda r: r.id, lambda c: c.sum())])' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_MultipleMultiple_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::sort(~name->meta::pure::functions::relation::ascending())->meta::pure::functions::relation::groupBy(~[grp], ~[newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'),YoCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.id:y: Integer[*]|$y->plus()])',
               '(lambda frame:' +
               '  frame.sort(["name"]).group_by(grouping_columns=["grp"], aggregate_specifications=[("newCol", lambda r: r.name, lambda c: c.join(\'\')), ("YoCol", lambda r: r.id, lambda c: c.sum())])' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::groupBy::testSimpleGroupBy_MultipleMultiple_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t = #TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#;\n'+
                  ' $t->meta::pure::functions::relation::groupBy(~[grp], ~[newCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.name:y: String[*]|$y->meta::pure::functions::string::joinStrings(\'\'),YoCol:x: (id:Integer, grp:Integer, name:String)[1]|$x.id:y: Integer[*]|$y->plus()]);\n'+
                  '',
               '(lambda frame:' +
               '  frame.sort(["name"]).group_by(["grp"], [("newCol", lambda r: r.name, lambda c: c.join(\'\')), ("YoCol", lambda r: r.id, lambda c: c.sum())])' +
               ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J"))')
        ]
      )
    ]->combine(),
    [
      meta::pure::functions::relation::tests::join::testSimpleJoinShared_Function_1__Boolean_1_->testRev(
        [
          rev('|$tds->meta::pure::functions::relation::join($tds2, meta::pure::functions::relation::JoinKind.INNER, {x: (id:Integer, name:String)[1], y: (id2:Integer, col:String, other:Integer)[1]|$x.id == $y.id2})',
               '(lambda frame:' +
               '  frame.join(csv_frame("id2,col,other\\n1,More George 1,1\\n1,More George 2,2\\n4,More David,1"), (lambda x , y : x.id == y.id2) , "INNER")' +
               ')(csv_frame("id,name\\n1,George\\n2,Pierre\\n3,Sachin\\n4,David"))'),
          rev('|$tds->meta::pure::functions::relation::join($tds2, meta::pure::functions::relation::JoinKind.LEFT, {x: (id:Integer, name:String)[1], y: (id2:Integer, col:String, other:Integer)[1]|$x.id == $y.id2})',
               '(lambda frame:' +
               '  frame.join(csv_frame("id2,col,other\\n1,More George 1,1\\n1,More George 2,2\\n4,More David,1"), (lambda x , y : x.id == y.id2))' +
               ')(csv_frame("id,name\\n1,George\\n2,Pierre\\n3,Sachin\\n4,David"))')
        ]
      ),

      meta::pure::functions::relation::tests::join::testSimpleJoin_MultipleExpressions_Function_1__Boolean_1_->testRev(
        [
          rev('|let t1 = #TDS{\n'+
                  'id,name\n'+
                  '1,George\n'+
                  '2,Pierre\n'+
                  '3,Sachin\n'+
                  '4,David}#;\n'+
                  ' let t2 = #TDS{\n'+
                  'id2,col,other\n'+
                  '1,MoreGeorge1,1\n'+
                  '1,MoreGeorge2,2\n'+
                  '4,MoreDavid,1}#;\n'+
                  ' $t1->meta::pure::functions::relation::join($t2, meta::pure::functions::relation::JoinKind.INNER, {x: (id:Integer, name:String)[1], y: (id2:Integer, col:String, other:Integer)[1]|$x.id == $y.id2});\n'+
                  '',
               '(lambda frame:' +
               '  frame.join(csv_frame("id2,col,other\\n1,More George 1,1\\n1,More George 2,2\\n4,More David,1"), (lambda x , y : x.id == y.id2) , "INNER")' +
               ')(csv_frame("id,name\\n1,George\\n2,Pierre\\n3,Sachin\\n4,David"))'),
          rev('|let t1 = #TDS{\n'+
                  'id,name\n'+
                  '1,George\n'+
                  '2,Pierre\n'+
                  '3,Sachin\n'+
                  '4,David}#;\n'+
                  ' let t2 = #TDS{\n'+
                  'id2,col,other\n'+
                  '1,MoreGeorge1,1\n'+
                  '1,MoreGeorge2,2\n'+
                  '4,MoreDavid,1}#;\n'+
                  ' $t1->meta::pure::functions::relation::join($t2, meta::pure::functions::relation::JoinKind.LEFT, {x: (id:Integer, name:String)[1], y: (id2:Integer, col:String, other:Integer)[1]|$x.id == $y.id2});\n'+
                  '',
                '(lambda frame:' +
               '  frame.join(csv_frame("id2,col,other\\n1,More George 1,1\\n1,More George 2,2\\n4,More David,1"), (lambda x , y : x.id == y.id2))' +
               ')(csv_frame("id,name\\n1,George\\n2,Pierre\\n3,Sachin\\n4,David"))')
        ]
      ),

      meta::pure::functions::relation::tests::join::testJoin_forFailedJoinWhenNoRowsMatchJoinCondition_Function_1__Boolean_1_->testRev(
        [
          rev('|let t1 = #TDS{\n'+
                  'id,col,other\n'+
                  '1,MoreTest1,1\n'+
                  '2,MoreTest2,2}#;\n'+
                  ' let t2 = #TDS{\n'+
                  'id2,name\n'+
                  '3,Pierre}#;\n'+
                  ' $t1->meta::pure::functions::relation::join($t2, meta::pure::functions::relation::JoinKind.LEFT, {x: (id:Integer, col:String, other:Integer)[1], y: (id2:Integer, name:String)[1]|$x.id == $y.id2});\n'+
                  '',
                '(lambda frame:' +
               '  frame.join(csv_frame("id2,name\\n3,Pierre"), (lambda x , y : x.id == y.id2))' +
               ')(csv_frame("id,col,other\\n1,More Test 1,1\\n2,More Test 2,2"))')
        ]
      ),

      meta::pure::functions::relation::tests::join::testRightJoin_Function_1__Boolean_1_->testRev(
        [
          rev('|$tds->meta::pure::functions::relation::join($tds2, meta::pure::functions::relation::JoinKind.RIGHT, {x: (id:Integer, name:String)[1], y: (id2:Integer, col:String, other:Integer)[1]|$x.id == $y.id2})',
               '(lambda frame:' +
               '  frame.join(csv_frame("id2,col,other\\n1,More George 1,1\\n1,More George 2,2\\n4,More David,1\\n6,John,3"), (lambda x , y : x.id == y.id2), "RIGHT_OUTER")' +
               ')(csv_frame("id,name\\n1,George\\n2,Pierre\\n3,Sachin\\n4,David\\n5,Foo"))')
        ]
      )

    ]->combine(),
    [
      // Composition -------------------------------------
      meta::pure::functions::relation::tests::composition::testExtendFilter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str\n'+
                  '1,a\n'+
                  '3,ewe\n'+
                  '4,qw\n'+
                  '5,wwe\n'+
                  '6,weq}#->meta::pure::functions::relation::extend(~newCol:x: (val:Integer, str:String)[1]|$x.str->meta::pure::functions::multiplicity::toOne() + $x.val->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString())->meta::pure::functions::relation::filter(x: (val:Integer, str:String, newCol:String)[1]|$x.newCol == \'qw4\')',
               '(lambda frame:' +
               '  frame.extend(("newCol", lambda r: r.str + r.val.to_string())).filter((lambda x: x.newCol == \'qw4\'))' +
               ')(csv_frame("val,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testFilterPostProject_Function_1__Boolean_1_->testRev(
        [
          noRev('|[^meta::pure::functions::relation::tests::composition::FirmTypeForCompositionTests(legalName=\'Firm X\', employees=[^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Peter\', lastName=\'Smith\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'John\', lastName=\'Johnson\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'John\', lastName=\'Hill\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Anthony\', lastName=\'Allen\')]), ^meta::pure::functions::relation::tests::composition::FirmTypeForCompositionTests(legalName=\'Firm A\', employees=^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Fabrice\', lastName=\'Roberts\'))]->meta::pure::functions::relation::project(~[legalName:x: meta::pure::functions::relation::tests::composition::FirmTypeForCompositionTests[1]|$x.legalName,firstName:x: meta::pure::functions::relation::tests::composition::FirmTypeForCompositionTests[1]|$x.employees.firstName])->meta::pure::functions::relation::filter(x: (legalName:String, firstName:String)[1]|$x.legalName == \'Firm X\')')
        ]
      ),

      meta::pure::functions::relation::tests::composition::test_GroupBy_GroupBy_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str,str2\n'+
                  '2,a,b\n'+
                  '3,a,b\n'+
                  '4,qw,b\n'+
                  '5,qw,c\n'+
                  '2,weq,c}#->meta::pure::functions::relation::groupBy(~[str,str2], ~newCol:x: (val:Integer, str:String, str2:String)[1]|$x.val:x: Integer[*]|$x->plus())->meta::pure::functions::relation::groupBy(~[str], ~newCol2:x: (str:String, str2:String, newCol:Integer)[1]|$x.newCol:x: Integer[*]|$x->plus())',
               '(lambda frame:' +
               '  frame.group_by(["str","str2"], [("newCol", lambda r: r.val, lambda c: c.sum())]).group_by(["str"], [("newCol2", lambda r: r.newCol, lambda c: c.sum())])' +
               ')(csv_frame("val,str,str2\\n2,a,b\\n3,a,b\\n4,qw,b\\n5,qw,c\\n2,weq,c"))')
        ]
      ),
      
      meta::pure::functions::relation::tests::composition::test_GroupBy_Filter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str\n'+
                  '2,a\n'+
                  '3,a\n'+
                  '4,qw\n'+
                  '5,qw\n'+
                  '2,weq}#->meta::pure::functions::relation::groupBy(~str, ~newCol:x: (val:Integer, str:String)[1]|$x.val:x: Integer[*]|$x->plus())->meta::pure::functions::relation::filter(x: (str:String, newCol:Integer)[1]|$x.newCol > 4)',
               '(lambda frame:' +
               '  frame.group_by(["str"],[("newCol", lambda x : x.val , lambda c : c.sum())]).filter((lambda x : x.newCol > 4))' +
               ')(csv_frame("val,str\\n2,a\\n3,a\\n4,qw\\n5,qw\\n2,weq"))')
        ]
      ),
      
      meta::pure::functions::relation::tests::composition::test_Distinct_GroupBy_Filter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str,str2\n'+
                  '2,a,b\n'+
                  '2,a,b\n'+
                  '4,qw,b\n'+
                  '5,qw,c\n'+
                  '2,weq,c}#->meta::pure::functions::relation::distinct()->meta::pure::functions::relation::groupBy(~[str], ~newCol:x: (val:Integer, str:String, str2:String)[1]|$x.val:x: Integer[*]|$x->plus())->meta::pure::functions::relation::filter(x: (str:String, newCol:Integer)[1]|$x.newCol > 2)',
               '(lambda frame:' +
               '  frame.distinct().group_by(["str"],[("newCol",lambda x : x.val , lambda c : c.sum())]).filter((lambda x : x.newCol>2))' +
               ')(csv_frame("val,str,str2\\n2,a,b\\n2,a,b\\n4,qw,b\\n5,qw,c\\n2,weq,c"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testWindowFunctionsAfterProject_Function_1__Boolean_1_->testRev(
        [
          noRev('|[^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Peter\', lastName=\'Smith\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Peter\', lastName=\'Johnson\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Peter\', lastName=\'Hill\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Anthony\', lastName=\'Allen\'), ^meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests(firstName=\'Anthony\', lastName=\'Roberts\')]->meta::pure::functions::relation::project(~[first:x: meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests[1]|$x.firstName,last:x: meta::pure::functions::relation::tests::composition::PersonTypeForCompositionTests[1]|$x.lastName])->meta::pure::functions::relation::extend(~first->meta::pure::functions::relation::over(~last->meta::pure::functions::relation::ascending()), ~[leadLast:{p: meta::pure::metamodel::relation::Relation<(first:String, last:String)>[1], w: meta::pure::functions::relation::_Window<(first:String, last:String)>[1], r: (first:String, last:String)[1]|$p->meta::pure::functions::relation::lead($r).last},lagLast:{p: meta::pure::metamodel::relation::Relation<(first:String, last:String)>[1], w: meta::pure::functions::relation::_Window<(first:String, last:String)>[1], r: (first:String, last:String)[1]|$p->meta::pure::functions::relation::lag($r).last}])->meta::pure::functions::relation::sort([~first->meta::pure::functions::relation::ascending(), ~last->meta::pure::functions::relation::ascending()])')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testExtendWindowFilter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,B\n'+
                  '3,3,C\n'+
                  '4,4,D\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,H\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.id}:y: Integer[*]|$y->plus())->meta::pure::functions::relation::filter(x: (id:Integer, grp:Integer, name:String, newCol:Integer)[1]|($x.newCol > 9) && ($x.grp == 1))',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", []), [("newCol", lambda p, w, r: r.id , lambda c: c.sum())])'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,B\\n3,3,C\\n4,4,D\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,H\\n9,5,I\\n10,0,J")).filter(lambda x: (x["newCol"] > 9 and x["grp"] == 1))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testGroupByFilterExtendFilter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp,rank\n'+
                '1,A,1\n'+
                '2,A,1\n'+
                '3,B,2\n'+
                '4,D,3\n'+
                '5,B,2\n'+
                '6,A,1\n'+
                '7,C,4\n'+
                '8,A,2\n'+
                '9,C,3\n'+
                '10,D,1}#->meta::pure::functions::relation::groupBy(~[grp,rank], ~sumId:x: (id:Integer, grp:String, rank:Integer)[1]|$x.id:x: Integer[*]|$x->plus())->meta::pure::functions::relation::filter(x: (grp:String, rank:Integer, sumId:Integer)[1]|$x.rank <= 2)->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(), ~sumRank:{p: meta::pure::metamodel::relation::Relation<(grp:String, rank:Integer, sumId:Integer)>[1], w: meta::pure::functions::relation::_Window<(grp:String, rank:Integer, sumId:Integer)>[1], r: (grp:String, rank:Integer, sumId:Integer)[1]|$r.rank}:y: Integer[*]|$y->plus())->meta::pure::functions::relation::filter(x: (grp:String, rank:Integer, sumId:Integer, sumRank:Integer)[1]|$x.sumRank == 3)',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", []), [("sumRank",lambda p,w,r : r.rank , lambda c:c.sum())])'+
              ')(csv_frame("id,grp,rank\\n1,A,1\\n2,A,1\\n3,B,2\\n4,D,3\\n5,B,2\\n6,A,1\\n7,C,4\\n8,A,2\\n9,C,3\\n10,D,1").group_by(["grp","rank"],[("sumId", lambda x: x.id , lambda c: c.sum())]).filter(lambda x: x.rank <= 2)).filter(lambda x:x.sumRank == 3)')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testMixColumnNamesRenameFilter_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'colOneNum,Col_two_letter,_col_3Mix\n'+
                '1,A,1\n'+
                '2,A,1\n'+
                '3,B,2\n'+
                '4,D,3\n'+
                '5,B,2\n'+
                '6,A,1\n'+
                '7,C,4\n'+
                '8,A,2\n'+
                '9,C,3\n'+
                '10,D,1}#->meta::pure::functions::relation::rename(~colOneNum, ~_col_one_num)->meta::pure::functions::relation::rename(~Col_two_letter, ~colTwoLetter)->meta::pure::functions::relation::rename(~_col_3Mix, ~Col_3mix)->meta::pure::functions::relation::filter(x: (_col_one_num:Integer, colTwoLetter:String, Col_3mix:Integer)[1]|(($x._col_one_num > 2) && ($x.colTwoLetter == \'C\')) && ($x.Col_3mix == 3))',
            '(lambda frame:' +
            '  frame.rename(lambda r : (r.colOneNum , \'_col_one_num\')).rename(lambda r : (r.Col_two_letter , \'colTwoLetter\')).rename(lambda r : (r._col_3Mix , \'Col_3mix\')).filter((lambda x: ((x._col_one_num > 2) & (x.colTwoLetter == "C") & (x.Col_3mix == 3))))' +
            ')(csv_frame("colOneNum,Col_two_letter,_col_3Mix\\n1,A,1\\n2,A,1\\n3,B,2\\n4,D,3\\n5,B,2\\n6,A,1\\n7,C,4\\n8,A,2\\n9,C,3\\n10,D,1"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testMixColumnNamesRenameExtend_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'colOneNum,_Col_two_letter,col_3Mix\n'+
                '1,A,1\n'+
                '2,A,1\n'+
                '3,B,2\n'+
                '4,D,3\n'+
                '5,B,2\n'+
                '6,A,1\n'+
                '7,C,4\n'+
                '8,A,2\n'+
                '9,C,3\n'+
                '10,D,1}#->meta::pure::functions::relation::rename(~colOneNum, ~col_one_num)->meta::pure::functions::relation::rename(~_Col_two_letter, ~colTwoLetter)->meta::pure::functions::relation::rename(~col_3Mix, ~_Col_3mix)->meta::pure::functions::relation::extend(~newCol:c: (col_one_num:Integer, colTwoLetter:String, _Col_3mix:Integer)[1]|$c.col_one_num->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString() + $c.colTwoLetter->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString() + $c._Col_3mix->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString())->meta::pure::functions::relation::rename(~newCol, ~_new_col)->meta::pure::functions::relation::filter(x: (col_one_num:Integer, colTwoLetter:String, _Col_3mix:Integer, _new_col:String)[1]|$x._new_col->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString()->meta::pure::functions::string::contains(\'A\'))->meta::pure::functions::relation::rename(~_new_col, ~Result)->meta::pure::functions::relation::select(~[col_one_num,colTwoLetter,Result])',
            '(lambda frame:' +
            '  frame.rename(lambda r : (r.colOneNum , \'col_one_num\')).rename(lambda r : (r._Col_two_letter , \'colTwoLetter\')).rename(lambda r : (r.col_3Mix , \'_Col_3mix\')).extend(("newCol", lambda c : c.col_one_num.to_string() + c.colTwoLetter.to_string() + c._Col_3mix.to_string())).rename(lambda r : (r.newCol, "_new_col")).filter(lambda x: x._new_col.to_string().contains("A")).rename(lambda r: (r._new_col, "Result")).select(["col_one_num","colTwoLetter","Result"])' +
            ')(csv_frame("colOneNum,_Col_two_letter,col_3Mix\\n1,A,1\\n2,A,1\\n3,B,2\\n4,D,3\\n5,B,2\\n6,A,1\\n7,C,4\\n8,A,2\\n9,C,3\\n10,D,1"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testExtendJoinStringOnNull_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'id,grp,name\n'+
                  '1,2,A\n'+
                  '2,1,null\n'+
                  '3,3,C\n'+
                  '4,4,V\n'+
                  '5,2,E\n'+
                  '6,1,F\n'+
                  '7,3,G\n'+
                  '8,1,null\n'+
                  '9,5,I\n'+
                  '10,0,J}#->meta::pure::functions::relation::extend(~grp->meta::pure::functions::relation::over(), ~newCol:{p: meta::pure::metamodel::relation::Relation<(id:Integer, grp:Integer, name:String)>[1], w: meta::pure::functions::relation::_Window<(id:Integer, grp:Integer, name:String)>[1], r: (id:Integer, grp:Integer, name:String)[1]|$r.name}:y: String[*]|$y->meta::pure::functions::string::joinStrings(\':\'))',
              '(lambda frame: frame.window_extend(' +
              'frame.window( "grp", []), ("newCol",lambda p,w,r : r.name , lambda c : c.join(":")))'+
              ')(csv_frame("id,grp,name\\n1,2,A\\n2,1,null\\n3,3,C\\n4,4,V\\n5,2,E\\n6,1,F\\n7,3,G\\n8,1,null\\n9,5,I\\n10,0,J"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testGroupByOnNull_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                'id,grp\n'+
                '1,2\n'+
                '2,null\n'+
                '5,2\n'+
                '2,null\n'+
                '8,null\n'+
                '9,4\n'+
                '2,0}#->meta::pure::functions::relation::groupBy(~grp, ~newCol:x: (id:Integer, grp:Integer)[1]|$x.id:x: Integer[*]|$x->plus())',
             '(lambda frame:' +
             '  frame.group_by(["grp"],[("newCol", lambda x : x.id , lambda c : c.sum())])' +
             ')(csv_frame("id,grp\\n1,2\\n2,null\\n5,2\\n2,null\\n8,null\\n9,4\\n2,0"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testProjectDistinct_Function_1__Boolean_1_->testRev(
        [
          rev('|$tds->meta::pure::functions::relation::project(~[id:x: (id:Integer, name:String)[1]|$x.id,name:x: (id:Integer, name:String)[1]|$x.name->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toLower()])->meta::pure::functions::relation::distinct()',
          '(lambda frame: frame.project(' +
              '[("id", lambda x: x.id),("name", lambda x: x.name.lower())]).distinct()' +
           ')(csv_frame("\\nid,name\\n1,george\\n1,George\\n1,Sachin\\n2,David"))')
        ]
      ),

      meta::pure::functions::relation::tests::composition::testProjectJoinWithProjectProject_Function_1__Boolean_1_->testRev(
        [
          rev('|$tds->meta::pure::functions::relation::project(~[id1:x: (id:Integer, name:String)[1]|$x.id,name1:x: (id:Integer, name:String)[1]|$x.name])->meta::pure::functions::relation::join($tds2->meta::pure::functions::relation::project(~[id2:x: (id:Integer, col:String, other:Integer)[1]|$x.id,col:x: (id:Integer, col:String, other:Integer)[1]|$x.col,other:x: (id:Integer, col:String, other:Integer)[1]|$x.other]), meta::pure::functions::relation::JoinKind.INNER, {x: (id1:Integer, name1:String)[1], y: (id2:Integer, col:String, other:Integer)[1]|$x.id1 == $y.id2})->meta::pure::functions::relation::project(~[id:x: (id1:Integer, name1:String, id2:Integer, col:String, other:Integer)[1]|$x.id1,name:x: (id1:Integer, name1:String, id2:Integer, col:String, other:Integer)[1]|$x.col])',
          '(lambda frame1 , frame2: frame1.project(' +
              '[("id1", lambda x: x.id),("name1", lambda x: x.name)]).join(frame2.project([("id2", lambda x: x.id),("col", lambda x: x.col),("other", lambda x: x.other)]),(lambda x , y : x.id1 == y.id2) , "INNER").project([("id", lambda x: x.id1),("name", lambda x: x.col)])' +
           ')(csv_frame("\\nid,name\\n1,George\\n2,Pierre\\n3,Sachin\\n4,David"),csv_frame("\\nid,col,other\\n1,More George 1,1\\n1,More George 2,2\\n4,More David,1"))')
        ]
      )

    ]->combine(),
    [

      meta::pure::functions::relation::tests::project::testSimpleProject_Function_1__Boolean_1_->testRev(
        [
          noRev('|^meta::pure::functions::relation::tests::project::TypeForProjectTest(name=\'ok\', addresses=[^meta::pure::functions::relation::tests::project::Address(val=\'no\'), ^meta::pure::functions::relation::tests::project::Address(val=\'other\')], values=[^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=1), ^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=2), ^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=3)])->meta::pure::functions::relation::project(~[one:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.name,two:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.addresses.val,three:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.values.val])')
        ]
      ),

      meta::pure::functions::relation::tests::project::testSimpleProjectList_Function_1__Boolean_1_->testRev(
        [
          noRev('|[^meta::pure::functions::relation::tests::project::TypeForProjectTest(name=\'ok\', addresses=[^meta::pure::functions::relation::tests::project::Address(val=\'no\'), ^meta::pure::functions::relation::tests::project::Address(val=\'other\')], values=[^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=1), ^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=2), ^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=3)]), ^meta::pure::functions::relation::tests::project::TypeForProjectTest(name=\'ok3\', addresses=^meta::pure::functions::relation::tests::project::Address(val=\'no\'), values=[^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=1), ^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=2), ^meta::pure::functions::relation::tests::project::PrimitiveContainer(val=3)])]->meta::pure::functions::relation::project(~[one:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.name,two:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.addresses.val,three:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.values.val])')
        ]
      ),

      meta::pure::functions::relation::tests::project::testSimpleProjectWithEmpty_Function_1__Boolean_1_->testRev(
        [
          noRev('|^meta::pure::functions::relation::tests::project::TypeForProjectTest(name=\'ok\', addresses=[^meta::pure::functions::relation::tests::project::Address(val=\'no\'), ^meta::pure::functions::relation::tests::project::Address(val=\'other\')], values=[])->meta::pure::functions::relation::project(~[one:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.name,two:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.addresses.val,three:x: meta::pure::functions::relation::tests::project::TypeForProjectTest[1]|$x.values.val])')
        ]
      ),

      meta::pure::functions::relation::tests::project::testSimpleRelationProject_Function_1__Boolean_1_->testRev(
        [
          rev('|#TDS{\n'+
                  'val,str\n'+
                  '1,a\n'+
                  '3,ewe\n'+
                  '4,qw\n'+
                  '5,wwe\n'+
                  '6,weq}#->meta::pure::functions::relation::project(~[name:c: (val:Integer, str:String)[1]|$c.str->meta::pure::functions::multiplicity::toOne() + $c.val->meta::pure::functions::multiplicity::toOne()->meta::pure::functions::string::toString()])',
            '(lambda frame: frame.project(' +
              '[("name", lambda x: x.str + x.val.to_string())]).distinct()' +
           ')(csv_frame("\\nval,str\\n1,a\\n3,ewe\\n4,qw\\n5,wwe\\n6,weq"))')
        ]
      )

    ]->combine()
  ]
}